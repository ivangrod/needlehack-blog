



<!doctype html>
  <!--[if lt IE 7]>      <html lang="en" class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
  <!--[if IE 7]>         <html lang="en" class="no-js lt-ie9 lt-ie8"> <![endif]-->
  <!--[if IE 8]>         <html lang="en" class="no-js lt-ie9"> <![endif]-->
  <!--[if gt IE 8]><!--> <html lang="en"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>History Stats - Home Assistant</title>
    <meta name="author" content="Home Assistant">
    <meta name="description" content="Instructions about how to integrate historical statistics into Home Assistant.">
    
    <meta name="viewport" content="width=device-width">
    <link rel="canonical" href="https://www.home-assistant.io/integrations/history_stats/">

    <meta property="fb:app_id" content="338291289691179">
    <meta property="og:title" content="History Stats">
    <meta property="og:site_name" content="Home Assistant">
    <meta property="og:url" content="https://www.home-assistant.io/integrations/history_stats/">
    <meta property="og:type" content="article">
    <meta property="og:description" content="Instructions about how to integrate historical statistics into Home Assistant.">
    <meta property="og:image" content="https://ivangrod.github.io/needlehack-blog/images/default-social.png">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@home_assistant">
    
    <meta name="twitter:title" content="History Stats">
    <meta name="twitter:description" content="Instructions about how to integrate historical statistics into Home Assistant.">
    <meta name="twitter:image" content="https://ivangrod.github.io/needlehack-blog/images/default-social.png">
    <link rel="me" href="https://fosstodon.org/@homeassistant">

    <link href="https://cdn.jsdelivr.net/npm/@docsearch/css@3/dist/style.min.css" rel="stylesheet" />
    <link href="/stylesheets/prism.css?8acb84bc0387c9548a63998fcfea0139" rel="stylesheet">
    <link href="/stylesheets/screen.css?3d79f9acc1b3464b313d68cd5a171ca1" media="screen, projection, print" rel="stylesheet">
    <link href="/atom.xml" rel="alternate" title="Home Assistant" type="application/atom+xml">
    <link rel='shortcut icon' href='/images/favicon.ico' />
    <link rel='icon' type='image/png' href='/images/favicon-192x192.png' sizes='192x192' />

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Figtree:ital,wght@0,300..900;1,300..900&amp;family=Instrument+Sans:ital,wdth,wght@0,99,400..700;1,99,400..700&amp;" rel="stylesheet">
    <script src="https://code.iconify.design/iconify-icon/2.1.0/iconify-icon.min.js"></script>
  </head>

  <body  class=" integration-page  ">
    <header class='site-header '>
      



<div class="grid-wrapper">
  <div class="grid">
    <div class="grid__item three-tenths lap-two-sixths palm-one-whole ha-title">
      <a href="/" class="site-title">
        <div class="logo"></div>
      </a>
      <a class="release-date" href="/blog/2025/09/03/release-20259/" title="Latest version 2025.9.4 released September 19, 2025">
        2025.9.4
      </a>
    </div>

    <div class="grid__item seven-tenths lap-four-sixths palm-one-whole">
      <nav>
        <input type="checkbox" id="toggle" />
        <label
          for="toggle"
          class="toggle"
          data-open="Main Menu"
          data-close="⨉"
        ></label>
        <ul class="menu pull-right">
          <li><a  href="/installation/">Getting started</a></li>
          <li>
            <a  href="/docs/">Documentation <iconify-icon inline icon='mdi:chevron-down' title='Chevron down'></iconify-icon></a>
            <ul>
              <li><a href="/installation/"><iconify-icon inline icon='simple-icons:homeassistant' title='Homeassistant'></iconify-icon> Installation</a></li>
              <li><a href="/docs/automation/"><iconify-icon inline icon='mdi:robot-happy' title='Robot happy'></iconify-icon> Automations</a></li>
              <li><a href="/dashboards/"><iconify-icon inline icon='mdi:gauge' title='Gauge'></iconify-icon> Dashboards</a></li>
              <li><a href="/voice_control/"><iconify-icon inline icon='mdi:comment-processing-outline' title='Comment processing outline'></iconify-icon> Voice assistants</a></li>
              <li><a href="/docs/organizing/"><iconify-icon inline icon='mdi:view-grid' title='View grid'></iconify-icon> Device organization</a></li>
              <li><a href="/docs/energy/"><iconify-icon inline icon='mdi:solar-power-variant' title='Solar power variant'></iconify-icon> Energy management</a></li>
              <li><a href="/docs/configuration/"><iconify-icon inline icon='mdi:cog' title='Cog'></iconify-icon> Advanced configuration</a></li>
            </ul>
          </li>
          <li><a class="active" href="/integrations/">Integrations</a></li>
          <li><a  href="/blog/">Blog</a></li>
          <li><a  href="/help/">Need help?</a></li>
          <li>
            <div class="docsearch" id="docsearch"></div>
          </li>
        </ul>
      </nav>
    </div>
  </div>
</div>

    </header>

    <div class="page-content">

      

      <div class="grid-wrapper">
        <div class="grid grid-center">

          <aside id="toc-bar" class="grid__item desk-wide-one-sixth">
                <section class="aside-module grid__item one-whole">
                  <div class='section'>
                    <h1 class="title epsilon"><iconify-icon inline icon='mdi:toc' title='Toc'></iconify-icon> On this page</h1>
                    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="#configuration">Configuration</a></li>
<li class="toc-entry toc-h2"><a href="#yaml-configuration">YAML Configuration</a></li>
<li class="toc-entry toc-h2"><a href="#sensor-type">Sensor type</a></li>
<li class="toc-entry toc-h2"><a href="#time-periods">Time periods</a>
<ul>
<li class="toc-entry toc-h3"><a href="#duration">Duration</a></li>
<li class="toc-entry toc-h3"><a href="#video-tutorial">Video tutorial</a></li>
<li class="toc-entry toc-h3"><a href="#examples">Examples</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#related-topics">Related topics</a></li>
</ul>
                  </div>
                </section>
              </aside> 

          
          <div class="grid__item two-thirds desk-wide-seven-twelfths lap-one-whole palm-one-whole">
          

            
              <article class="page">
  
  <header>
    
    
      <div class="breadcrumbs">
        <a href="/">Home</a>
        
          
            
            ▸ <a href="/integrations/">Integrations</a>
          
        
          
            ▸ 
          
        
      </div>
    
    <h1 class="title indent">
      
        History Stats
      
    </h1>
  </header>
  
    
    
    
  
  
  <p>The <strong>History stats</strong> <span class="terminology">integration<span class="terminology-tooltip">Integrations connect and integrate Home Assistant with your devices, services, and more.<a class="terminology-link" href="/getting-started/concepts-terminology/#integrations"> [Learn more]</a></span></span> provides quick statistics about another integration or platforms, using data from the <a href="/integrations/history/"><code>history</code></a> integration.</p>
<p>It can track how long an <span class="terminology">entity<span class="terminology-tooltip">An entity represents a sensor, actor, or function in Home Assistant. Entities are used to monitor physical properties or to control other entities. An entity is usually part of a device or a service.<a class="terminology-link" href="/docs/configuration/entities_domains/"> [Learn more]</a></span></span> has been in a specific state, in a custom time period.</p>
<p>Examples of what you can track:</p>
<ul>
<li>How long you were at home this week</li>
<li>How long the lights were ON yesterday</li>
<li>How long you watched TV today</li>
</ul>
<h2>Configuration <a class="title-link" name="configuration" href="#configuration"></a>
</h2>
<p>To add the <strong>History Stats</strong> helper to your Home Assistant instance, use this My button:</p>
<p><a href="https://my.home-assistant.io/redirect/config_flow_start?domain=history_stats" class="my badge" target="_blank"><img src="https://my.home-assistant.io/badges/config_flow_start.svg"></a></p>
<div class="details-block">
  <details class="details-block-item">
    <summary class="details-block-title">
      <span><iconify-icon inline icon="mdi:cursor-hand"></iconify-icon> Manual configuration steps</span>
      <div class="details-block-arrow">
      <svg class="down" width="24" height="24" viewbox="0 0 24 24"><path d="M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"></path></svg>
      <svg class="up" width="24" height="24" viewbox="0 0 24 24"><path d="M7.41,15.41L12,10.83L16.59,15.41L18,14L12,8L6,14L7.41,15.41Z"></path></svg>
      </div>
    </summary>
    <div class="details-block-content" id="content_0">
<p>If the above My button doesn’t work, you can also perform the following steps
manually:</p>
<ul>
<li>
<p>Browse to your Home Assistant instance.</p>
</li>
<li>
<p>Go to <strong><a href="https://my.home-assistant.io/redirect/integrations" class="my" target="_blank"><iconify-icon inline icon="mdi:devices"></iconify-icon> Settings &gt; Devices &amp; Services</a></strong>.</p>
</li>
<li>
<p>At the top of the screen, select the tab: <strong><a href="https://my.home-assistant.io/redirect/helpers" class="my" target="_blank">Helpers</a></strong>.</p>
</li>
<li>
<p>In the bottom right corner, select the
<strong><a href="https://my.home-assistant.io/redirect/config_flow_start?domain=history_stats" class="my" target="_blank"><iconify-icon inline icon="mdi:plus"></iconify-icon> Create helper</a></strong> button.</p>
</li>
<li>
<p>From the list, select <strong>History Stats</strong>.</p>
</li>
<li>
<p>Follow the instructions on screen to complete the setup.</p>
</li>
</ul>
</div>
  </details>
</div>
<p>Further information and examples about these configuration options can be found under the <a href="#yaml-configuration">YAML configuration</a></p>
<div class="config-vars basic">
  <div class="">
<div class="config-vars-item">
<div class="config-vars-label">
<span class="config-vars-label-name">Name</span><a name="name" class="title-link" href="#name"></a>
</div>
<div class="config-vars-description-and-children"><span class="config-vars-description"><p>The name the sensor should have.</p>
</span></div>
</div>
<div class="config-vars-item">
<div class="config-vars-label">
<span class="config-vars-label-name">Entity</span><a name="entity" class="title-link" href="#entity"></a>
</div>
<div class="config-vars-description-and-children"><span class="config-vars-description"><p>The entity that provides the input.</p>
</span></div>
</div>
<div class="config-vars-item">
<div class="config-vars-label">
<span class="config-vars-label-name">State</span><a name="state" class="title-link" href="#state"></a>
</div>
<div class="config-vars-description-and-children"><span class="config-vars-description"><p>Which states of the input entity is counted in the statistics.</p>
</span></div>
</div>
<div class="config-vars-item">
<div class="config-vars-label">
<span class="config-vars-label-name">Type</span><a name="type" class="title-link" href="#type"></a>
</div>
<div class="config-vars-description-and-children"><span class="config-vars-description"><p>Any of <code>time</code>, <code>ratio</code> or <code>count</code>.</p>
</span></div>
</div>
<div class="config-vars-item">
<div class="config-vars-label">
<span class="config-vars-label-name">Start</span><a name="start" class="title-link" href="#start"></a>
</div>
<div class="config-vars-description-and-children"><span class="config-vars-description"><p>When to start the measure (timestamp or datetime). Can be a template.</p>
</span></div>
</div>
<div class="config-vars-item">
<div class="config-vars-label">
<span class="config-vars-label-name">End</span><a name="end" class="title-link" href="#end"></a>
</div>
<div class="config-vars-description-and-children"><span class="config-vars-description"><p>When to stop the measure (timestamp or datetime). Can be a template.</p>
</span></div>
</div>
<div class="config-vars-item">
<div class="config-vars-label">
<span class="config-vars-label-name">Duration</span><a name="duration" class="title-link" href="#duration"></a>
</div>
<div class="config-vars-description-and-children"><span class="config-vars-description"><p>Duration of the measure.</p>
</span></div>
</div>
</div>
</div>
<h2>YAML Configuration <a class="title-link" name="yaml-configuration" href="#yaml-configuration"></a>
</h2>
<p>To enable the history statistics sensor, add the following lines to your <span class="terminology"><code>configuration.yaml</code><span class="terminology-tooltip">The configuration.yaml file is the main configuration file for Home Assistant. It lists the integrations to be loaded and their specific configurations. In some cases, the configuration needs to be edited manually directly in the configuration.yaml file. Most integrations can be configured in the UI.<a class="terminology-link" href="/docs/configuration/"> [Learn more]</a></span></span> file.
After changing the <span class="terminology"><code>configuration.yaml</code><span class="terminology-tooltip">The configuration.yaml file is the main configuration file for Home Assistant. It lists the integrations to be loaded and their specific configurations. In some cases, the configuration needs to be edited manually directly in the configuration.yaml file. Most integrations can be configured in the UI.<a class="terminology-link" href="/docs/configuration/"> [Learn more]</a></span></span> file, <a href="/docs/configuration/#reloading-the-configuration-to-apply-changes">restart Home Assistant</a> to apply the changes.</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="yaml"><span class="c1"># Example configuration.yaml entry</span>
<span class="na">sensor</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">platform</span><span class="pi">:</span> <span class="s">history_stats</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">Lamp ON today</span>
    <span class="na">entity_id</span><span class="pi">:</span> <span class="s">light.my_lamp</span>
    <span class="na">state</span><span class="pi">:</span> <span class="s2">"</span><span class="s">on"</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">time</span>
    <span class="na">start</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">today_at()</span><span class="nv"> </span><span class="s">}}"</span>
    <span class="na">end</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">now()</span><span class="nv"> </span><span class="s">}}"</span>
</code></pre></div></div>
<div class="config-vars">
  <h4>
    Configuration Variables <a class="title-link" name="history_stats-configuration-variables" href="#history_stats-configuration-variables"></a>
  </h4>
  <div class="configuration-link">
    <a href="/docs/configuration/" target="_blank">Looking for your configuration file?</a>
  </div>
  <div class="">
<div class="config-vars-item">
<div class="config-vars-label">
<span class="config-vars-label-name"> entity_id </span><span class="config-vars-type">string</span><span class="config-vars-required"> <span class="true">Required</span><span class="default"></span></span><a name="entity_id" class="title-link" href="#entity_id"></a>
</div>
<div class="config-vars-description-and-children"><span class="config-vars-description"><p>The entity you want to track.</p>
</span></div>
</div>
<div class="config-vars-item">
<div class="config-vars-label">
<span class="config-vars-label-name"> unique_id </span><span class="config-vars-type">string</span><span class="config-vars-required"> (<span class="false">Optional</span><span class="default"></span>)</span><a name="unique_id" class="title-link" href="#unique_id"></a>
</div>
<div class="config-vars-description-and-children"><span class="config-vars-description"><p>An ID that uniquely identifies this entity. Set this to a unique value to allow customization through the UI.</p>
</span></div>
</div>
<div class="config-vars-item">
<div class="config-vars-label">
<span class="config-vars-label-name"> state </span><span class="config-vars-type">list | string</span><span class="config-vars-required"> <span class="true">Required</span><span class="default"></span></span><a name="state" class="title-link" href="#state"></a>
</div>
<div class="config-vars-description-and-children"><span class="config-vars-description"><p>The states you want to track.</p>
</span></div>
</div>
<div class="config-vars-item">
<div class="config-vars-label">
<span class="config-vars-label-name"> name </span><span class="config-vars-type">string</span><span class="config-vars-required"> (<span class="false">Optional</span><span class="default">, default: unnamed statistics</span>)</span><a name="name" class="title-link" href="#name"></a>
</div>
<div class="config-vars-description-and-children"><span class="config-vars-description"><p>Name displayed on the frontend. Note that it is used by Home Assistant to generate sensor’s <code>object_id</code> so it is advisable to choose a unique one and change name for frontend using <a href="/docs/configuration/customizing-devices/#friendly_name">customization</a> or via <a href="/dashboards/entities/#name">Dashboards</a>.</p>
</span></div>
</div>
<div class="config-vars-item">
<div class="config-vars-label">
<span class="config-vars-label-name"> type </span><span class="config-vars-type">string</span><span class="config-vars-required"> (<span class="false">Optional</span><span class="default">, default: time</span>)</span><a name="type" class="title-link" href="#type"></a>
</div>
<div class="config-vars-description-and-children"><span class="config-vars-description"><p>The type of sensor: <code>time</code>, <code>ratio</code>, or <code>count</code>.</p>
</span></div>
</div>
<div class="config-vars-item">
<div class="config-vars-label">
<span class="config-vars-label-name"> start </span><span class="config-vars-type"><a href="/docs/configuration/templating/">template</a></span><span class="config-vars-required"> (<span class="false">Optional</span><span class="default"></span>)</span><a name="start" class="title-link" href="#start"></a>
</div>
<div class="config-vars-description-and-children"><span class="config-vars-description"><p>When to start the measure (timestamp or datetime).</p>
</span></div>
</div>
<div class="config-vars-item">
<div class="config-vars-label">
<span class="config-vars-label-name"> end </span><span class="config-vars-type"><a href="/docs/configuration/templating/">template</a></span><span class="config-vars-required"> (<span class="false">Optional</span><span class="default"></span>)</span><a name="end" class="title-link" href="#end"></a>
</div>
<div class="config-vars-description-and-children"><span class="config-vars-description"><p>When to stop the measure (timestamp or datetime).</p>
</span></div>
</div>
<div class="config-vars-item">
<div class="config-vars-label">
<span class="config-vars-label-name"> duration </span><span class="config-vars-type">time</span><span class="config-vars-required"> (<span class="false">Optional</span><span class="default"></span>)</span><a name="duration" class="title-link" href="#duration"></a>
</div>
<div class="config-vars-description-and-children"><span class="config-vars-description"><p>Duration of the measure.</p>
</span></div>
</div>
</div>
</div>
<div class="alert alert-note">
  <p class="alert-title"><iconify-icon inline icon="mdi:information-outline"></iconify-icon> Note</p>
  <div class="alert-content">
<p>You have to provide <strong>exactly 2</strong> of <code>start</code>, <code>end</code> and <code>duration</code>.
<br>
You can use <a href="/docs/configuration/templating/#home-assistant-template-extensions">template extensions</a> such as <code>now()</code> or <code>as_timestamp()</code> to handle dynamic dates, as shown in the examples below.</p>
  </div>
</div>
<h2>Sensor type <a class="title-link" name="sensor-type" href="#sensor-type"></a>
</h2>
<p>Depending on the sensor type you choose, the <code>history_stats</code> integration can show different values:</p>
<ul>
<li>
<strong>time</strong>: The default value, which is the tracked time, in hours</li>
<li>
<strong>ratio</strong>: The tracked time divided by the length of your period, as a percentage</li>
<li>
<strong>count</strong>: How many times the tracked entity matched the configured state during the time period. This will count states (for example, how many times a light was in the <code>on</code> state during the time period), as opposed to counting state transitions (for example, how many times a light was <em>turned</em> <code>on</code>). The difference is if the entity was already in the desired state at the start of the time period, that scenario will be counted with this sensor type. If a list of states is provided to the state option, transitions between defined states are considered all part of a single event and do not increment the count.</li>
</ul>
<div class="alert alert-note">
  <p class="alert-title"><iconify-icon inline icon="mdi:information-outline"></iconify-icon> Note</p>
  <div class="alert-content">
<p>For a <strong>time</strong> or <strong>count</strong> sensor that uses a time period that does not slide (such as one that resets upon each hour, as opposed to one which considers the trailing 60 minutes), consider using <a href="/docs/configuration/customizing-devices/#customizing-an-entity-in-yaml">customization</a> to change the <code>state_class</code> to <code>total_increasing</code> to generate statistics that track the <code>sum</code>. This is useful when emulating the behavior of a <code>utility_meter</code> helper that has a defined reset cycle. Without intervention, the <code>state_class</code> of any <code>history_stats</code> sensor will be <code>measurement</code> and will therefore generate <code>average</code>, <code>min</code>, and <code>max</code> statistics.</p>
  </div>
</div>
<h2>Time periods <a class="title-link" name="time-periods" href="#time-periods"></a>
</h2>
<p>The <code>history_stats</code> integration will execute a measure within a precise time period. You should always provide 2 of the following :</p>
<ul>
<li>When the period starts (<code>start</code> variable)</li>
<li>When the period ends (<code>end</code> variable)</li>
<li>How long is the period (<code>duration</code> variable)</li>
</ul>
<p>As <code>start</code> and <code>end</code> variables can be either datetimes or timestamps, you can configure almost any period you want.</p>
<h3>Duration <a class="title-link" name="duration" href="#duration"></a>
</h3>
<p>The duration variable is used when the time period is fixed. Different syntaxes for the duration are supported, as shown below.</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="yaml"><span class="c1"># 6 hours</span>
<span class="na">duration</span><span class="pi">:</span> <span class="s2">"</span><span class="s">06:00"</span>
</code></pre></div></div>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="yaml"><span class="c1"># 1 minute, 30 seconds</span>
<span class="na">duration</span><span class="pi">:</span> <span class="s2">"</span><span class="s">00:01:30"</span>
</code></pre></div></div>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="yaml"><span class="c1"># 2 hours and 30 minutes</span>
<span class="na">duration</span><span class="pi">:</span>
  <span class="c1"># supports seconds, minutes, hours, days</span>
  <span class="na">hours</span><span class="pi">:</span> <span class="m">2</span>
  <span class="na">minutes</span><span class="pi">:</span> <span class="m">30</span>
</code></pre></div></div>
<div class="alert alert-note">
  <p class="alert-title"><iconify-icon inline icon="mdi:information-outline"></iconify-icon> Note</p>
  <div class="alert-content">
<p>If the duration exceeds the number of days of history stored by the <code>recorder</code> integration (<code>purge_keep_days</code>), the history statistics sensor will not have all the information it needs to look at the entire duration. For example, if <code>purge_keep_days</code> is set to 7, a history statistics sensor with a duration of 30 days will only report a value based on the last 7 days of history.</p>
  </div>
</div>
<div class="alert alert-note">
  <p class="alert-title"><iconify-icon inline icon="mdi:information-outline"></iconify-icon> Note</p>
  <div class="alert-content">
<p>The history stats sensor will be updated when the source entity changes or once per minute if there is no source change. Keep this in mind when using fixed durations that aren’t evenly divisible by one minute.</p>
  </div>
</div>
<h3>Video tutorial <a class="title-link" name="video-tutorial" href="#video-tutorial"></a>
</h3>
<p>This video tutorial explains how you can use history stats. It also shows how you can create a daily bar chart graph to visualize things such as occupancy, or how long the lights are on in a particular room.</p>
<p><lite-youtube videoid="BMlU4SynQBY" videotitle="How To Master Graphs to Monitor Occupancy and Device Usage in Home Assistant" posterquality="maxresdefault"></lite-youtube></p>
<h3>Examples <a class="title-link" name="examples" href="#examples"></a>
</h3>
<p>Here are some examples of periods you could work with, and what to write in your <span class="terminology"><code>configuration.yaml</code><span class="terminology-tooltip">The configuration.yaml file is the main configuration file for Home Assistant. It lists the integrations to be loaded and their specific configurations. In some cases, the configuration needs to be edited manually directly in the configuration.yaml file. Most integrations can be configured in the UI.<a class="terminology-link" href="/docs/configuration/"> [Learn more]</a></span></span>:</p>
<p><strong>Today</strong>: starts at 00:00 of the current day and ends right now.</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="yaml">    <span class="na">start</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">today_at('00:00')</span><span class="nv"> </span><span class="s">}}"</span>
    <span class="na">end</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">now()</span><span class="nv"> </span><span class="s">}}"</span>
</code></pre></div></div>
<p><strong>Yesterday</strong>: ends today at 00:00, lasts 24 hours.</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="yaml">    <span class="na">end</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">today_at('00:00')</span><span class="nv"> </span><span class="s">}}"</span>
    <span class="na">duration</span><span class="pi">:</span>
      <span class="na">hours</span><span class="pi">:</span> <span class="m">24</span>
</code></pre></div></div>
<p><strong>This morning (6AM - 11AM)</strong>: starts today at 6, lasts 5 hours.</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="yaml">    <span class="na">start</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">today_at('06:00')</span><span class="nv"> </span><span class="s">}}"</span>
    <span class="na">duration</span><span class="pi">:</span>
      <span class="na">hours</span><span class="pi">:</span> <span class="m">5</span>
</code></pre></div></div>
<p><strong>Current week</strong>: starts last Monday at 00:00, ends right now.</p>
<p>Here, last Monday is today at 00:00, minus the current weekday (the weekday is 0 on Monday, 6 on Sunday).</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="yaml">    <span class="na">start</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">today_at('00:00')</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">timedelta(days=now().weekday())</span><span class="nv"> </span><span class="s">}}"</span>
    <span class="na">end</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">now()</span><span class="nv"> </span><span class="s">}}"</span>
</code></pre></div></div>
<p><strong>Current month</strong>: starts the first day of the current month at 00:00, ends right now.</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="yaml">    <span class="na">start</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">today_at('00:00').replace(day=1)</span><span class="nv"> </span><span class="s">}}"</span>
    <span class="na">end</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">now()</span><span class="nv"> </span><span class="s">}}"</span>
</code></pre></div></div>
<p><strong>Previous month</strong>: starts the first day of the previous month at 00:00, ends the first day of the current month.</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="yaml">    <span class="na">start</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">(today_at('00:00').replace(day=1)</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">timedelta(days=1)).replace(day=1)</span><span class="nv"> </span><span class="s">}}"</span>
    <span class="na">end</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">today_at('00:00').replace(day=1)</span><span class="nv"> </span><span class="s">}}"</span>
</code></pre></div></div>
<p><strong>Next 4 pm</strong>: 24 hours, from the last 4 pm till the next 4 pm. If it hasn’t been 4 pm today, that would be 4 pm yesterday until 4 pm today. If it is already past 4 pm today, it will be 4 pm today until 4 pm tomorrow. When changing the start time, then add or subtract to the 8-hour buffer to match the next midnight.</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="yaml">    <span class="na">end</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">(now()</span><span class="nv"> </span><span class="s">+</span><span class="nv"> </span><span class="s">timedelta(hours=8)).replace(hour=16,</span><span class="nv"> </span><span class="s">minute=0,</span><span class="nv"> </span><span class="s">second=0,</span><span class="nv"> </span><span class="s">microsecond=0)</span><span class="nv"> </span><span class="s">}}"</span>
    <span class="na">duration</span><span class="pi">:</span>
        <span class="na">hours</span><span class="pi">:</span> <span class="m">24</span>
</code></pre></div></div>
<p><strong>Last 30 days</strong>: ends today at 00:00, lasts 30 days. Easy one.</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="yaml">    <span class="na">end</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">today_at('00:00')</span><span class="nv"> </span><span class="s">}}"</span>
    <span class="na">duration</span><span class="pi">:</span>
      <span class="na">days</span><span class="pi">:</span> <span class="m">30</span>
</code></pre></div></div>
<p><strong>All your history</strong> starts at timestamp = 0, and ends right now.</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="yaml">    <span class="na">start</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">0</span><span class="nv"> </span><span class="s">}}"</span>
    <span class="na">end</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">now()</span><span class="nv"> </span><span class="s">}}"</span>
</code></pre></div></div>
<div class="alert alert-tip">
  <p class="alert-title"><iconify-icon inline icon="mdi:lightbulb-outline"></iconify-icon> Tip</p>
  <div class="alert-content">
<p>The <code>/developer-tools/template</code> page of your Home Assistant UI can help you check if the values for <code>start</code>, <code>end</code> or <code>duration</code> are correct. If you want to check if your period is right, just click on your component, the <code>from</code> and <code>to</code> attributes will show the start and end of the period, nicely formatted.</p>
  </div>
</div>


  

<div class="text related-topics">
  <h2>Related topics<a class="title-link" href="#related-topics" name="related-topics"></a>
</h2>
  <ul>
    
    
    
    
    
    <li>
      <a href="/docs/configuration/" class="topic">
        Configuration file
      </a>
    </li>
    </ul>
</div>


  
<div class="material-card text feedback">
  <h4>
<iconify-icon inline icon="mdi:feedback" title="Feedback"></iconify-icon> <b> Help us improve our documentation</b><a href="#feedback_section" class="title-link" name="feedback_section"></a>
</h4>
  Suggest an edit to this page, or provide/view feedback for this page.
  <div class="links">
    <ul aria-label="Page feedback options">
    <li><a href="https://github.com/home-assistant/home-assistant.io/tree/current/source/_integrations/history_stats.markdown" target="_blank" title="Edit this page"><iconify-icon inline icon="mdi:edit"></iconify-icon> Edit</a></li>
    
    <li><a href="https://github.com/home-assistant/home-assistant.io/issues/new?template=feedback.yml&amp;url=https%3A%2F%2Fivangrod.github.io%2Fneedlehack-blog%2Fintegrations%2Fhistory_stats%2F&amp;version=2025.9.4&amp;labels=current,integration%3A%20history_stats" target="_blank" title="Provide feedback on this page"><iconify-icon inline icon="mdi:comment-edit-outline"></iconify-icon> Provide feedback</a></li>
    <li><a href="https://github.com/home-assistant/home-assistant.io/issues?q=is%3Aissue+is%3Aopen+sort%3Aupdated-desc+label%3A%22integration%3A+history_stats%22" target="_blank" title="View pending feedback for this page"><iconify-icon inline icon="mdi:comment-text-multiple-outline"></iconify-icon> View pending feedback</a></li>
    
  </ul>
  </div>
</div>


</article>

            
          </div>


          
            
              <aside id="integration-sidebar" class="grid__item one-third desk-wide-one-quarter lap-one-whole palm-one-whole">
              
            <div class="grid">
  




  


<section class="aside-module grid__item one-whole lap-one-half">
  <div class='brand-logo-container section'>
      <img src='https://brands.home-assistant.io/_/history_stats//logo.png' srcset='https://brands.home-assistant.io/_/history_stats/logo@2x.png 2x' /><a href='https://my.home-assistant.io/redirect/config_flow_start?domain=history_stats' class='my badge' target='_blank'><img src='https://my.home-assistant.io/badges/config_flow_start.svg' /></a></div>

  <div class='section'>The History Stats  helper  was introduced in Home Assistant 0.39, and it's used by <a title="Open analytics.home-assistant.io" href="https://analytics.home-assistant.io/integrations" target="_blank" rel="noopener">
        
          3.5%</a> of the active installations.
        
      
    
  </div>
    <div class='section'>
      <iconify-icon icon='mdi:download-network-outline'></iconify-icon>&nbsp;Its IoT class is <a href='/blog/2016/02/12/classifying-the-internet-of-things/#classifiers'>Local Polling.</a>
    </div>
  <div class='section'>
    <a href='/docs/quality_scale/#-internal'>🏠 Internal integration</a><br /></div>
  <div class='section'>
    <a href="https://github.com/home-assistant/core/tree/dev/homeassistant/components/history_stats" target="_blank"><iconify-icon inline icon='simple-icons:github' title='Github'></iconify-icon> View source on GitHub</a><br />
    <a href="https://github.com/home-assistant/core/issues?q=is%3Aissue+is%3Aopen+label%3A%22integration%3A+history_stats%22" target="_blank"><iconify-icon inline icon='mdi:bug' title='Bug'></iconify-icon> View known issues</a>
  </div></section>

<section class="aside-module grid__item one-whole lap-one-half">
  <div class='section'>
    <h1 class="title epsilon"><iconify-icon inline icon='mdi:person-heart' title='Person heart'></iconify-icon> Integration owners</h1>
    
      <div class="section">
        This integration is community maintained.<br />
        If you are a developer and would like to help, feel free to contribute!
      </div>
    
  </div>
</section>






  <section id="toc-module" class="aside-module grid__item one-whole lap-one-half">
        <div class='section'>
          <h1 class="title epsilon"><iconify-icon inline icon='mdi:toc' title='Toc'></iconify-icon> On this page</h1>
          <ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="#configuration">Configuration</a></li>
<li class="toc-entry toc-h2"><a href="#yaml-configuration">YAML Configuration</a></li>
<li class="toc-entry toc-h2"><a href="#sensor-type">Sensor type</a></li>
<li class="toc-entry toc-h2"><a href="#time-periods">Time periods</a>
<ul>
<li class="toc-entry toc-h3"><a href="#duration">Duration</a></li>
<li class="toc-entry toc-h3"><a href="#video-tutorial">Video tutorial</a></li>
<li class="toc-entry toc-h3"><a href="#examples">Examples</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#related-topics">Related topics</a></li>
</ul>
        </div>
      </section><section id="category-module" class="aside-module grid__item one-whole lap-one-half">
      <div class='section'>
        <h1 class="title epsilon"><iconify-icon inline icon='mdi:category' title='Category'></iconify-icon> Categories</h1>
        <ul class='divided'><li>
            <a href='/integrations/#helper'>Helper</a>
          </li><li>
            <a href='/integrations/#sensor'>Sensor</a>
          </li><li>
            <a href='/integrations/#utility'>Utility</a>
          </li></ul>
      </div>
    </section></div>

          </aside>
          
        </div>
      </div>

      <footer>
        <div class="grid-wrapper">
  <div class="grid">
    <div class="grid__item">
      <div class="skyline grid">
        <div class="skyline grid__item one-whole">
          <div class="footer-skyline">
          </div>
        </div>
      </div>
      <div class="footer-nav grid">
        <div class="company grid__item one-quarter lap-one-half palm-one-whole">
          <div class="title">
            <img
              src="/images/footer-logo-text.svg"
              height="72"
              alt="Home Assistant"
            />
          </div>
          <p>
            Home Assistant is a project from the <a href="https://www.openhomefoundation.org/">Open Home Foundation</a>, sponsored by <a href="https://www.nabucasa.com/">Nabu Casa</a>.
          </p>
        </div>

        <div class="grid__item one-quarter lap-one-half palm-one-whole">
          <h3>Join us and contribute!</h3>
          <ul>
            <li><a class="external-link" href="https://github.com/home-assistant/">GitHub repo <iconify-icon inline icon='tabler:external-link' title='External link'></iconify-icon></a></li>
            <li><a class="external-link" href="https://developers.home-assistant.io">Developers Portal <iconify-icon inline icon='tabler:external-link' title='External link'></iconify-icon></a></li>
            <li><a class="external-link" href="https://design.home-assistant.io">Design Portal <iconify-icon inline icon='tabler:external-link' title='External link'></iconify-icon></a></li>
            <li><a class="external-link" href="https://data.home-assistant.io">Data Science Portal <iconify-icon inline icon='tabler:external-link' title='External link'></iconify-icon></a></li>
            <li><a class="external-link" href="https://community.home-assistant.io">Community Forum <iconify-icon inline icon='tabler:external-link' title='External link'></iconify-icon></a></li>
            <li><a class="external-link" href="https://creators.home-assistant.io/">Creator Network <iconify-icon inline icon='tabler:external-link' title='External link'></iconify-icon></a></li>
            <li><a class="external-link" href="https://works-with.home-assistant.io/">Works With Home Assistant <iconify-icon inline icon='tabler:external-link' title='External link'></iconify-icon></a></li>
            <li><a href="/community">Our community</li>
            <li><a href="/help/reporting_issues/">Reporting issues</a></li>
          </ul>
          <h3>System status</h3>
          <ul>
            <li>
              <a class="external-link"  href="https://alerts.home-assistant.io">Integration Alerts <iconify-icon inline icon='tabler:external-link' title='External link'></iconify-icon></a>
            </li>
            <li><a href="/security/">Security Alerts</a></li>
            <li>
              <a class="external-link" href="https://status.home-assistant.io">System Status <iconify-icon inline icon='tabler:external-link' title='External link'></iconify-icon></a>
            </li>
          </ul>
        </div>

        <div class="grid__item one-quarter lap-one-half palm-one-whole">
          <h3>Companion apps</h3>
          <ul>
            <li><a class="external-link" href="https://apps.apple.com/us/app/home-assistant/id1099568401">iOS and Apple devices</a></li>
            <li><a class="external-link" href="https://play.google.com/store/apps/details?id=io.homeassistant.companion.android">Android and Wear OS</a></li>
            <li><a class="external-link" href="https://companion.home-assistant.io/">...and more!</a></li>
          </ul>
          <h3>Governance</h3>
          <ul>
            <li><a href="/privacy/">Privacy Notices</a></li>
            <li><a href="/developers/cla/">Contributor License Agreement</a></li>
            <li><a href="/tos/">Terms of Service</a></li>
            <li><a href="/code_of_conduct/">Code of Conduct</a></li>
            <li><a href="/developers/credits/">Credits</a></li>
            <li><a href="/developers/license/">License</a></li>
          </ul>
        </div>

        <div class="socials grid__item one-quarter lap-one-half palm-one-whole">

          <h3>Follow us</h3>
          <p><a class="external-link" href='https://newsletter.openhomefoundation.org/#/portal'>Sign up for our newsletter <iconify-icon inline icon='tabler:external-link' title='External link'></iconify-icon></a></p>
          <div class="icons">
            <a
              rel="me"
              href="https://youtube.com/@home_assistant"
              title="YouTube"
              target="_blank"
              ><iconify-icon icon="simple-icons:youtube"></iconify-icon></a>
            <a
              rel="me"
              href="https://reddit.com/r/homeassistant"
              title="Reddit"
              target="_blank"
              ><iconify-icon icon="simple-icons:reddit"></iconify-icon></a>
            <a
              rel="me"
              href="https://github.com/home-assistant/home-assistant"
              title="GitHub"
              target="_blank"
              ><iconify-icon icon="simple-icons:github"></iconify-icon></a>
            <br />
            <a
              rel="me"
              href="https://fosstodon.org/@homeassistant"
              title="Mastodon"
              target="_blank"
              ><iconify-icon icon="simple-icons:mastodon"></iconify-icon></a>
            <a
              rel="me"
              href="https://bsky.app/profile/home-assistant.io"
              title="Bluesky"
              target="_blank"
             ><iconify-icon icon="simple-icons:bluesky"></iconify-icon></a>
            <a
              rel="me"
              href="https://x.com/home_assistant"
              title="X"
              target="_blank"
             ><iconify-icon icon="simple-icons:x"></iconify-icon></a>
            <br />
            <a
              rel="me"
              href="https://www.facebook.com/homeassistantio"
              title="Facebook"
              target="_blank"
              ><iconify-icon icon="simple-icons:facebook"></iconify-icon></a>
            <a
              rel="me"
              href="https://www.instagram.com/homeassistant/"
              title="Instagram"
              target="_blank"
              ><iconify-icon icon="simple-icons:instagram"></iconify-icon></a>
            <a
              rel="me"
              href="https://www.linkedin.com/company/home-assistant"
              title="LinkedIn"
              target="_blank"
              ><iconify-icon icon="simple-icons:linkedin"></iconify-icon></a>
          </div>

          <div class="web-notice">
            <p>
              For partnership inquiries please check out <a href="https://works-with.home-assistant.io/">Works With Home Assistant</a>. For media, get in touch <a href="mailto:media@openhomefoundation.org">here</a>. For other questions, you can contact us <a href="mailto:hello@home-assistant.io">here</a> (No technical support!)
            </p>
            <p>
              Website powered by <a href="https://jekyllrb.com/">Jekyll</a><br />
              Originally based on the <a href="https://github.com/coogie/oscailte">Oscailte theme</a>
            </p>
            <a href="https://www.netlify.com">
              <img
                src="/images/frontpage/netlify.svg"
                alt="Deploys by Netlify Badge"
              />
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

      </footer>

    </div>
    <script type="module" src="https://cdn.jsdelivr.net/npm/@justinribeiro/lite-youtube@1.3.1/lite-youtube.js"></script>

<script src="/javascripts/terminology_tooltip.js?274cec0734bc752f0e5ea3d4e2e59858" type="text/javascript" defer></script>

<script src="/javascripts/prism.js?5d6619066a1fc5cd819a93c132b539ac" type="text/javascript" defer></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@docsearch/js@3/dist/umd/index.min.js"></script>
<script type="text/javascript">
  docsearch({
    container: '#docsearch',
    appId: 'FBHBYS3J0U',
    indexName: 'home-assistant',
    apiKey: "ba6f7e6d97b3d3d2f778978c742a47c6",
  });
  document.querySelector('.site-title').addEventListener('contextmenu', function (ev) {
    ev.preventDefault();
    document.location.assign("https://design.home-assistant.io/#brand/logo")
  });
</script>




<script type="text/javascript">
  {
    const article = document.querySelector("article.post");
    if (article) {
      const iframes = article.querySelectorAll("iframe[data-src]");
      let loaded = false;
      if (iframes) {
        document.addEventListener('mousemove', loadLazyFrames, { passive: true, once: true });
        document.addEventListener('touchmove', loadLazyFrames, { passive: true, once: true });
        document.addEventListener('scroll', loadLazyFrames, { passive: true, once: true });
  
        function loadLazyFrames() {
          if (loaded) return;
          loaded = true;
  
          iframes.forEach((iframe) => {
            const src = iframe.getAttribute("data-src");
            if (src) {
              iframe.setAttribute("src", src);
              iframe.removeAttribute("data-src");
            }
          });
        }
      }
    }
  }
</script>

  </body>
</html>
