



<!doctype html>
  <!--[if lt IE 7]>      <html lang="en" class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
  <!--[if IE 7]>         <html lang="en" class="no-js lt-ie9 lt-ie8"> <![endif]-->
  <!--[if IE 8]>         <html lang="en" class="no-js lt-ie9"> <![endif]-->
  <!--[if gt IE 8]><!--> <html lang="en"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>MySensors - Home Assistant</title>
    <meta name="author" content="Home Assistant">
    <meta name="description" content="Instructions on how to integrate MySensors into Home Assistant.">
    
    <meta name="viewport" content="width=device-width">
    <link rel="canonical" href="https://www.home-assistant.io/integrations/mysensors/">

    <meta property="fb:app_id" content="338291289691179">
    <meta property="og:title" content="MySensors">
    <meta property="og:site_name" content="Home Assistant">
    <meta property="og:url" content="https://www.home-assistant.io/integrations/mysensors/">
    <meta property="og:type" content="article">
    <meta property="og:description" content="Instructions on how to integrate MySensors into Home Assistant.">
    <meta property="og:image" content="https://ivangrod.github.io/images/default-social.png">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@home_assistant">
    
    <meta name="twitter:title" content="MySensors">
    <meta name="twitter:description" content="Instructions on how to integrate MySensors into Home Assistant.">
    <meta name="twitter:image" content="https://ivangrod.github.io/images/default-social.png">
    <link rel="me" href="https://fosstodon.org/@homeassistant">

    <link href="https://cdn.jsdelivr.net/npm/@docsearch/css@3/dist/style.min.css" rel="stylesheet" />
    <link href="/stylesheets/prism.css?8acb84bc0387c9548a63998fcfea0139" rel="stylesheet">
    <link href="/stylesheets/screen.css?3d79f9acc1b3464b313d68cd5a171ca1" media="screen, projection, print" rel="stylesheet">
    <link href="/atom.xml" rel="alternate" title="Home Assistant" type="application/atom+xml">
    <link rel='shortcut icon' href='/images/favicon.ico' />
    <link rel='icon' type='image/png' href='/images/favicon-192x192.png' sizes='192x192' />

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Figtree:ital,wght@0,300..900;1,300..900&amp;family=Instrument+Sans:ital,wdth,wght@0,99,400..700;1,99,400..700&amp;" rel="stylesheet">
    <script src="https://code.iconify.design/iconify-icon/2.1.0/iconify-icon.min.js"></script>
  </head>

  <body  class=" integration-page  ">
    <header class='site-header '>
      



<div class="grid-wrapper">
  <div class="grid">
    <div class="grid__item three-tenths lap-two-sixths palm-one-whole ha-title">
      <a href="/needlehack-blog/" class="site-title">
        <div class="logo"></div>
      </a>
      <a class="release-date" href="/blog/2025/09/03/release-20259/" title="Latest version 2025.9.4 released September 19, 2025">
        2025.9.4
      </a>
    </div>

    <div class="grid__item seven-tenths lap-four-sixths palm-one-whole">
      <nav>
        <input type="checkbox" id="toggle" />
        <label
          for="toggle"
          class="toggle"
          data-open="Main Menu"
          data-close="â¨‰"
        ></label>
        <ul class="menu pull-right">
          <li><a  href="/needlehack-blog/installation/">Getting started</a></li>
          <li>
            <a  href="/needlehack-blog/docs/">Documentation <iconify-icon inline icon='mdi:chevron-down' title='Chevron down'></iconify-icon></a>
            <ul>
              <li><a href="/needlehack-blog/installation/"><iconify-icon inline icon='simple-icons:homeassistant' title='Homeassistant'></iconify-icon> Installation</a></li>
              <li><a href="/needlehack-blog/docs/automation/"><iconify-icon inline icon='mdi:robot-happy' title='Robot happy'></iconify-icon> Automations</a></li>
              <li><a href="/needlehack-blog/dashboards/"><iconify-icon inline icon='mdi:gauge' title='Gauge'></iconify-icon> Dashboards</a></li>
              <li><a href="/needlehack-blog/voice_control/"><iconify-icon inline icon='mdi:comment-processing-outline' title='Comment processing outline'></iconify-icon> Voice assistants</a></li>
              <li><a href="/needlehack-blog/docs/organizing/"><iconify-icon inline icon='mdi:view-grid' title='View grid'></iconify-icon> Device organization</a></li>
              <li><a href="/needlehack-blog/docs/energy/"><iconify-icon inline icon='mdi:solar-power-variant' title='Solar power variant'></iconify-icon> Energy management</a></li>
              <li><a href="/needlehack-blog/docs/configuration/"><iconify-icon inline icon='mdi:cog' title='Cog'></iconify-icon> Advanced configuration</a></li>
            </ul>
          </li>
          <li><a class="active" href="/needlehack-blog/integrations/">Integrations</a></li>
          <li><a  href="/needlehack-blog/blog/">Blog</a></li>
          <li><a  href="/needlehack-blog/help/">Need help?</a></li>
          <li>
            <div class="docsearch" id="docsearch"></div>
          </li>
        </ul>
      </nav>
    </div>
  </div>
</div>

    </header>

    <div class="page-content">

      

      <div class="grid-wrapper">
        <div class="grid grid-center">

          <aside id="toc-bar" class="grid__item desk-wide-one-sixth">
                <section class="aside-module grid__item one-whole">
                  <div class='section'>
                    <h1 class="title epsilon"><iconify-icon inline icon='mdi:toc' title='Toc'></iconify-icon> On this page</h1>
                    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="#configuration">Configuration</a>
<ul>
<li class="toc-entry toc-h3"><a href="#serial-gateway">Serial gateway</a></li>
<li class="toc-entry toc-h3"><a href="#mqtt-gateway">MQTT gateway</a></li>
<li class="toc-entry toc-h3"><a href="#ethernet-gateway">Ethernet gateway</a></li>
<li class="toc-entry toc-h3"><a href="#general-options">General options</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#presentation">Presentation</a></li>
<li class="toc-entry toc-h2"><a href="#smartsleep">SmartSleep</a></li>
<li class="toc-entry toc-h2"><a href="#message-validation">Message validation</a></li>
<li class="toc-entry toc-h2"><a href="#debug-logging">Debug logging</a></li>
<li class="toc-entry toc-h2"><a href="#binary-sensor">Binary sensor</a>
<ul>
<li class="toc-entry toc-h3"><a href="#mysensors-version-14-and-higher">MySensors version 1.4 and higher</a></li>
<li class="toc-entry toc-h3"><a href="#mysensors-version-15-and-higher">MySensors version 1.5 and higher</a></li>
<li class="toc-entry toc-h3"><a href="#binary-sensor-example-sketch">Binary sensor example sketch</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#climate">Climate</a>
<ul>
<li class="toc-entry toc-h3"><a href="#mysensors-version-15-and-higher-1">MySensors version 1.5 and higher</a></li>
<li class="toc-entry toc-h3"><a href="#climate-example-sketch-for-mysensors-2x">Climate example sketch for MySensors 2.x</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#cover">Cover</a>
<ul>
<li class="toc-entry toc-h3"><a href="#mysensors-version-14">MySensors version 1.4</a></li>
<li class="toc-entry toc-h3"><a href="#mysensors-version-15-and-higher-2">MySensors version 1.5 and higher</a></li>
<li class="toc-entry toc-h3"><a href="#cover-example-sketch">Cover example sketch</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#device-tracker">Device tracker</a>
<ul>
<li class="toc-entry toc-h3"><a href="#mysensors-version-20-and-higher">MySensors version 2.0 and higher</a></li>
<li class="toc-entry toc-h3"><a href="#device-tracker-example-sketch-for-mysensors-2x">Device tracker example sketch for MySensors 2.x</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#light">Light</a>
<ul>
<li class="toc-entry toc-h3"><a href="#mysensors-version-14-1">MySensors version 1.4</a></li>
<li class="toc-entry toc-h3"><a href="#mysensors-version-15-and-higher-3">MySensors version 1.5 and higher</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#remote">Remote</a>
<ul>
<li class="toc-entry toc-h3"><a href="#mysensors-version-14-and-higher-1">MySensors version 1.4 and higher</a></li>
<li class="toc-entry toc-h3"><a href="#mysensors-version-15-and-higher-4">MySensors version 1.5 and higher</a></li>
<li class="toc-entry toc-h3"><a href="#ir-transceiver-example-sketch">IR transceiver example sketch</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#sensor">Sensor</a>
<ul>
<li class="toc-entry toc-h3"><a href="#mysensors-version-14-and-higher-2">MySensors version 1.4 and higher</a></li>
<li class="toc-entry toc-h3"><a href="#mysensors-version-20-and-higher-1">MySensors version 2.0 and higher</a></li>
<li class="toc-entry toc-h3"><a href="#custom-unit-of-measurement">Custom unit of measurement</a></li>
<li class="toc-entry toc-h3"><a href="#sensor-example-sketch-for-mysensors-2x">Sensor example sketch for MySensors 2.x</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#switch">Switch</a>
<ul>
<li class="toc-entry toc-h3"><a href="#mysensors-version-14-and-higher-3">MySensors version 1.4 and higher</a></li>
<li class="toc-entry toc-h3"><a href="#mysensors-version-15-and-higher-5">MySensors version 1.5 and higher</a></li>
<li class="toc-entry toc-h3"><a href="#mysensors-version-20-and-higher-2">MySensors version 2.0 and higher</a></li>
<li class="toc-entry toc-h3"><a href="#switch-example-sketch">Switch example sketch</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#text">Text</a>
<ul>
<li class="toc-entry toc-h3"><a href="#mysensors-version-20-and-higher-3">MySensors version 2.0 and higher</a></li>
<li class="toc-entry toc-h3"><a href="#text-example-sketch">Text example sketch</a></li>
</ul>
</li>
</ul>
                  </div>
                </section>
              </aside> 

          
          <div class="grid__item two-thirds desk-wide-seven-twelfths lap-one-whole palm-one-whole">
          

            
              <article class="page">
  
  <header>
    
    
      <div class="breadcrumbs">
        <a href="/needlehack-blog/">Home</a>
        
          
            
            â–¸ <a href="/integrations/">Integrations</a>
          
        
          
            â–¸ 
          
        
      </div>
    
    <h1 class="title indent">
      
        MySensors
      
    </h1>
  </header>
  
    
    
    
  
  
  <p>The <a href="https://www.mysensors.org" rel="external nofollow">MySensors<iconify-icon inline="true" icon="tabler:external-link" class="external-link"></iconify-icon></a> project combines devices like Arduino, ESP8266, Raspberry Pi, NRF24L01+ and RFM69 to build affordable sensor networks. This integration will automatically add all available devices to Home Assistant, after <a href="#presentation">presentation</a> is done. That is, you do not need to add anything to your configuration for the devices for them to be added. Go to the <strong>states</strong> section of the developer tools to find the devices that have been identified.</p>
<h2>Configuration <a class="title-link" name="configuration" href="#configuration"></a>
</h2>
<p>To add the <strong>MySensors</strong> integration to your Home Assistant instance, use this My button:</p>
<p><a href="https://my.home-assistant.io/redirect/config_flow_start?domain=mysensors" class="my badge" target="_blank"><img src="https://my.home-assistant.io/badges/config_flow_start.svg"></a></p>
<div class="details-block">
  <details class="details-block-item">
    <summary class="details-block-title">
      <span><iconify-icon inline icon="mdi:cursor-hand"></iconify-icon> Manual configuration steps</span>
      <div class="details-block-arrow">
      <svg class="down" width="24" height="24" viewbox="0 0 24 24"><path d="M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"></path></svg>
      <svg class="up" width="24" height="24" viewbox="0 0 24 24"><path d="M7.41,15.41L12,10.83L16.59,15.41L18,14L12,8L6,14L7.41,15.41Z"></path></svg>
      </div>
    </summary>
    <div class="details-block-content" id="content_0">
<p>If the above My button doesnâ€™t work, you can also perform the following steps
manually:</p>
<ul>
<li>
<p>Browse to your Home Assistant instance.</p>
</li>
<li>
<p>Go to <strong><a href="https://my.home-assistant.io/redirect/integrations" class="my" target="_blank"><iconify-icon inline icon="mdi:devices"></iconify-icon> Settings &gt; Devices &amp; Services</a></strong>.</p>
</li>
<li>
<p>In the bottom right corner, select the
<strong><a href="https://my.home-assistant.io/redirect/config_flow_start?domain=mysensors" class="my" target="_blank"><iconify-icon inline icon="mdi:plus"></iconify-icon> Add Integration</a></strong> button.</p>
</li>
<li>
<p>From the list, select <strong>MySensors</strong>.</p>
</li>
<li>
<p>Follow the instructions on screen to complete the setup.</p>
</li>
</ul>
</div>
  </details>
</div>
<p>Configuration depends on the type of Gateway you use:</p>
<h3>Serial gateway <a class="title-link" name="serial-gateway" href="#serial-gateway"></a>
</h3>
<p>If you are using an original Arduino as a serial gateway, the port will be named <code>ttyACM*</code>. The exact number can be determined with the command shown below.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="bash"><span class="nb">ls</span> /dev/ttyACM<span class="k">*</span>
</code></pre></div></div>
<p>In addition to the serial device you also need to enter the baud rate.</p>
<h3>MQTT gateway <a class="title-link" name="mqtt-gateway" href="#mqtt-gateway"></a>
</h3>
<p>If you are using the MQTT gateway, you will need to enter topic prefixes for input and output. These need to be swapped
with the settings of the gateway. I.e. the input topic for Home Assistant needs to be the output (publish) topic of the gateway.</p>
<div class="alert alert-note">
  <p class="alert-title"><iconify-icon inline icon="mdi:information-outline"></iconify-icon> Note</p>
  <div class="alert-content">
<p>The MQTT gateway requires MySensors version 2.0+ and only the MQTT client gateway is supported.</p>
  </div>
</div>
<h3>Ethernet gateway <a class="title-link" name="ethernet-gateway" href="#ethernet-gateway"></a>
</h3>
<p>To use an Ethernet gateway, you need to configure the IP address and port of the gateway.</p>
<h3>General options <a class="title-link" name="general-options" href="#general-options"></a>
</h3>
<p>A few options are available for all gateways:</p>
<ul>
<li>
<p>persistence file:
Home Assistant will store detected nodes in a file. This means restarting Home Assistant will not require re-discovering of all the nodes. The persistence file option allows setting the path of the file. Leaving the option empty will make Home Assistant auto-generate a file name in the configuration directory.</p>
</li>
<li>
<p>version:
Enter the version of MySensors that you use for your gateway.</p>
</li>
</ul>
<h2>Presentation <a class="title-link" name="presentation" href="#presentation"></a>
</h2>
<p>Present a MySensors sensor or actuator, by following these steps:</p>
<p>Enter the version of MySensors that you use</p>
<ol>
<li>Start Home Assistant and configure the MySensors integration</li>
<li>Write and upload your MySensors sketch to the sensor. Make sure you:
<ul>
<li>Send sketch name.</li>
<li>Present the sensorâ€™s <code>S_TYPE</code>.</li>
<li>Send at least one initial value per <code>V_TYPE</code>. In version 2.x of MySensors, this has to be done in the loop function. See below for an example in 2.0 of how to make sure the initial value has been received by the controller.</li>
</ul>
</li>
<li>Start the sensor.</li>
</ol>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="cpp"><span class="cm">/*
 * Documentation: https://www.mysensors.org
 * Support Forum: https://forum.mysensors.org
 *
 * https://www.mysensors.org/build/relay
 */</span>

<span class="cp">#define MY_DEBUG
#define MY_RADIO_NRF24
#define MY_REPEATER_FEATURE
#define MY_NODE_ID 1
#include</span> <span class="cpf">&lt;SPI.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;MySensors.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;Bounce2.h&gt;</span><span class="cp">
</span>
<span class="cp">#define RELAY_PIN  5
#define BUTTON_PIN  3
#define CHILD_ID 1
#define RELAY_ON 1
#define RELAY_OFF 0
</span>
<span class="n">Bounce</span> <span class="n">debouncer</span> <span class="o">=</span> <span class="n">Bounce</span><span class="p">();</span>
<span class="kt">bool</span> <span class="n">state</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
<span class="kt">bool</span> <span class="n">initialValueSent</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>

<span class="n">MyMessage</span> <span class="nf">msg</span><span class="p">(</span><span class="n">CHILD_ID</span><span class="p">,</span> <span class="n">V_STATUS</span><span class="p">);</span>

<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">pinMode</span><span class="p">(</span><span class="n">BUTTON_PIN</span><span class="p">,</span> <span class="n">INPUT_PULLUP</span><span class="p">);</span>
  <span class="n">debouncer</span><span class="p">.</span><span class="n">attach</span><span class="p">(</span><span class="n">BUTTON_PIN</span><span class="p">);</span>
  <span class="n">debouncer</span><span class="p">.</span><span class="n">interval</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>

  <span class="c1">// Make sure relays are off when starting up</span>
  <span class="n">digitalWrite</span><span class="p">(</span><span class="n">RELAY_PIN</span><span class="p">,</span> <span class="n">RELAY_OFF</span><span class="p">);</span>
  <span class="n">pinMode</span><span class="p">(</span><span class="n">RELAY_PIN</span><span class="p">,</span> <span class="n">OUTPUT</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">presentation</span><span class="p">()</span>  <span class="p">{</span>
  <span class="n">sendSketchInfo</span><span class="p">(</span><span class="s">"Relay+button"</span><span class="p">,</span> <span class="s">"1.0"</span><span class="p">);</span>
  <span class="n">present</span><span class="p">(</span><span class="n">CHILD_ID</span><span class="p">,</span> <span class="n">S_BINARY</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">initialValueSent</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Sending initial value"</span><span class="p">);</span>
    <span class="n">send</span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">state</span><span class="o">?</span><span class="n">RELAY_ON</span><span class="o">:</span><span class="n">RELAY_OFF</span><span class="p">));</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Requesting initial value from controller"</span><span class="p">);</span>
    <span class="n">request</span><span class="p">(</span><span class="n">CHILD_ID</span><span class="p">,</span> <span class="n">V_STATUS</span><span class="p">);</span>
    <span class="n">wait</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="n">C_SET</span><span class="p">,</span> <span class="n">V_STATUS</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">debouncer</span><span class="p">.</span><span class="n">update</span><span class="p">())</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">debouncer</span><span class="p">.</span><span class="n">read</span><span class="p">()</span><span class="o">==</span><span class="n">LOW</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">state</span> <span class="o">=</span> <span class="o">!</span><span class="n">state</span><span class="p">;</span>
      <span class="c1">// Send new state and request ack back</span>
      <span class="n">send</span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">state</span><span class="o">?</span><span class="n">RELAY_ON</span><span class="o">:</span><span class="n">RELAY_OFF</span><span class="p">),</span> <span class="nb">true</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">receive</span><span class="p">(</span><span class="k">const</span> <span class="n">MyMessage</span> <span class="o">&amp;</span><span class="n">message</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">isAck</span><span class="p">())</span> <span class="p">{</span>
     <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"This is an ack from gateway"</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">V_STATUS</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">initialValueSent</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Receiving initial value from controller"</span><span class="p">);</span>
      <span class="n">initialValueSent</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">// Change relay state</span>
    <span class="n">state</span> <span class="o">=</span> <span class="p">(</span><span class="kt">bool</span><span class="p">)</span><span class="n">message</span><span class="p">.</span><span class="n">getInt</span><span class="p">();</span>
    <span class="n">digitalWrite</span><span class="p">(</span><span class="n">RELAY_PIN</span><span class="p">,</span> <span class="n">state</span><span class="o">?</span><span class="n">RELAY_ON</span><span class="o">:</span><span class="n">RELAY_OFF</span><span class="p">);</span>
    <span class="n">send</span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">state</span><span class="o">?</span><span class="n">RELAY_ON</span><span class="o">:</span><span class="n">RELAY_OFF</span><span class="p">));</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<h2>SmartSleep <a class="title-link" name="smartsleep" href="#smartsleep"></a>
</h2>
<p>Sending a heartbeat, <code>I_HEARTBEAT_RESPONSE</code>, from the MySensors device to Home Assistant, using MySensors version 2.0 - 2.1, activates the SmartSleep functionality in Home Assistant. This means that messages are buffered and only sent to the device upon receiving a heartbeat from the device. State changes are stored so that only the last requested state change is sent to the device. Other types of messages are queued in a FIFO queue. SmartSleep is useful for battery powered actuators that are waiting for commands. See the MySensors library API for information on how to send heartbeats and sleep the device.</p>
<p>In MySensors version 2.2 the serial API changed from using <code>I_HEARTBEAT_RESPONSE</code> to signal SmartSleep, to using <code>I_PRE_SLEEP_NOTIFICATION</code> and <code>I_POST_SLEEP_NOTIFICATION</code>. Home Assistant has been upgraded to support the new message types and will activate SmartSleep when receiving a message of type <code>I_PRE_SLEEP_NOTIFICATION</code>, if using MySensors version 2.2.x or higher. If Home Assistant is configured to use MySensors version 2.0 - 2.1 the old SmartSleep behavior is retained.</p>
<h2>Message validation <a class="title-link" name="message-validation" href="#message-validation"></a>
</h2>
<p>Messages sent to or from Home Assistant from or to a MySensors device will be validated according to the MySensors <a href="https://www.mysensors.org/download/serial_api_20" rel="external nofollow">serial API<iconify-icon inline="true" icon="tabler:external-link" class="external-link"></iconify-icon></a>. If a message doesnâ€™t pass validation, it will be dropped and not be passed forward either to or from Home Assistant. Make sure you follow the serial API for your version of MySensors when writing your Arduino sketch.</p>
<p>The log should warn you of messages that failed validation or if a child value is missing that is required for a certain child type. Home Assistant will log failed validations of child values at warning level if e.g.,  one required value type for a platform has been received, but other required value types are missing.</p>
<p>Message validation was introduced in version 0.52 of Home Assistant.</p>
<h2>Debug logging <a class="title-link" name="debug-logging" href="#debug-logging"></a>
</h2>
<p>If you experience dropped messages or that a device is not added to Home Assistant, please turn on debug logging for the <code>mysensors</code> integration and the <code>mysensors</code> package. This will help you see what is going on. Make sure you use these logging settings to collect a log sample if you report an issue about the <code>mysensors</code> integration in our GitHub issue tracker.</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="yaml"><span class="na">logger</span><span class="pi">:</span>
  <span class="na">default</span><span class="pi">:</span> <span class="s">info</span>
  <span class="na">logs</span><span class="pi">:</span>
    <span class="na">homeassistant.components.mysensors</span><span class="pi">:</span> <span class="s">debug</span>
    <span class="na">mysensors</span><span class="pi">:</span> <span class="s">debug</span>
</code></pre></div></div>
<p>Visit the <a href="https://www.mysensors.org/download" rel="external nofollow">library API<iconify-icon inline="true" icon="tabler:external-link" class="external-link"></iconify-icon></a> of MySensors for more information.</p>
<h2>Binary sensor <a class="title-link" name="binary-sensor" href="#binary-sensor"></a>
</h2>
<p>The following binary sensor types are supported:</p>
<h3>MySensors version 1.4 and higher <a class="title-link" name="mysensors-version-14-and-higher" href="#mysensors-version-14-and-higher"></a>
</h3>
<table>
<thead>
<tr>
<th>S_TYPE</th>
<th>V_TYPE</th>
</tr>
</thead>
<tbody>
<tr>
<td>S_DOOR</td>
<td>V_TRIPPED</td>
</tr>
<tr>
<td>S_MOTION</td>
<td>V_TRIPPED</td>
</tr>
<tr>
<td>S_SMOKE</td>
<td>V_TRIPPED</td>
</tr>
</tbody>
</table>
<h3>MySensors version 1.5 and higher <a class="title-link" name="mysensors-version-15-and-higher" href="#mysensors-version-15-and-higher"></a>
</h3>
<table>
<thead>
<tr>
<th>S_TYPE</th>
<th>V_TYPE</th>
</tr>
</thead>
<tbody>
<tr>
<td>S_SPRINKLER</td>
<td>V_TRIPPED</td>
</tr>
<tr>
<td>S_WATER_LEAK</td>
<td>V_TRIPPED</td>
</tr>
<tr>
<td>S_SOUND</td>
<td>V_TRIPPED</td>
</tr>
<tr>
<td>S_VIBRATION</td>
<td>V_TRIPPED</td>
</tr>
<tr>
<td>S_MOISTURE</td>
<td>V_TRIPPED</td>
</tr>
</tbody>
</table>
<h3>Binary sensor example sketch <a class="title-link" name="binary-sensor-example-sketch" href="#binary-sensor-example-sketch"></a>
</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="cpp"><span class="cm">/**
 * Documentation: https://www.mysensors.org
 * Support Forum: https://forum.mysensors.org
 *
 * https://www.mysensors.org/build/binary
 */</span>


<span class="cp">#include</span> <span class="cpf">&lt;MySensor.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;SPI.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;Bounce2.h&gt;</span><span class="cp">
</span>
<span class="cp">#define SN "BinarySensor"
#define SV "1.0"
#define CHILD_ID 1
#define BUTTON_PIN 3  // Arduino Digital I/O pin for button/reed switch.
</span>
<span class="n">MySensor</span> <span class="n">gw</span><span class="p">;</span>
<span class="n">Bounce</span> <span class="n">debouncer</span> <span class="o">=</span> <span class="n">Bounce</span><span class="p">();</span>
<span class="n">MyMessage</span> <span class="nf">msg</span><span class="p">(</span><span class="n">CHILD_ID</span><span class="p">,</span> <span class="n">V_TRIPPED</span><span class="p">);</span>

<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">gw</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
  <span class="n">gw</span><span class="p">.</span><span class="n">sendSketchInfo</span><span class="p">(</span><span class="n">SN</span><span class="p">,</span> <span class="n">SV</span><span class="p">);</span>
  <span class="c1">// Setup the button.</span>
  <span class="n">pinMode</span><span class="p">(</span><span class="n">BUTTON_PIN</span><span class="p">,</span> <span class="n">INPUT_PULLUP</span><span class="p">);</span>
  <span class="c1">// After setting up the button, setup debouncer.</span>
  <span class="n">debouncer</span><span class="p">.</span><span class="n">attach</span><span class="p">(</span><span class="n">BUTTON_PIN</span><span class="p">);</span>
  <span class="n">debouncer</span><span class="p">.</span><span class="n">interval</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
  <span class="n">gw</span><span class="p">.</span><span class="n">present</span><span class="p">(</span><span class="n">CHILD_ID</span><span class="p">,</span> <span class="n">S_DOOR</span><span class="p">);</span>
  <span class="n">gw</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">debouncer</span><span class="p">.</span><span class="n">update</span><span class="p">())</span> <span class="p">{</span>
    <span class="c1">// Get the update value.</span>
    <span class="kt">int</span> <span class="n">value</span> <span class="o">=</span> <span class="n">debouncer</span><span class="p">.</span><span class="n">read</span><span class="p">();</span>
    <span class="c1">// Send in the new value.</span>
    <span class="n">gw</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span> <span class="o">==</span> <span class="n">LOW</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">));</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<h2>Climate <a class="title-link" name="climate" href="#climate"></a>
</h2>
<p>The following actuator types are supported:</p>
<h3>MySensors version 1.5 and higher <a class="title-link" name="mysensors-version-15-and-higher-1" href="#mysensors-version-15-and-higher-1"></a>
</h3>
<table>
<thead>
<tr>
<th>S_TYPE</th>
<th>V_TYPE</th>
</tr>
</thead>
<tbody>
<tr>
<td>S_HVAC</td>
<td>V_HVAC_FLOW_STATE*, V_HVAC_SETPOINT_HEAT, V_HVAC_SETPOINT_COOL, V_HVAC_SPEED, V_TEMP</td>
</tr>
</tbody>
</table>
<p>V_HVAC_FLOW_STATE is mapped to the state of the Climate integration in Home Assistant as follows:</p>
<table>
<thead>
<tr>
<th>Home Assistant State</th>
<th>MySensors State</th>
</tr>
</thead>
<tbody>
<tr>
<td>HVAC_MODE_COOL</td>
<td>CoolOn</td>
</tr>
<tr>
<td>HVAC_MODE_HEAT</td>
<td>HeatOn</td>
</tr>
<tr>
<td>HVAC_MODE_AUTO</td>
<td>AutoChangeOver</td>
</tr>
<tr>
<td>HVAC_MODE_OFF</td>
<td>Off</td>
</tr>
</tbody>
</table>
<p>Currently humidity, away_mode, aux_heat, swing_mode is not supported. This will be included in later versions as feasible.</p>
<p>Set the target temperature using V_HVAC_SETPOINT_HEAT in Heat mode, and V_HVAC_SETPOINT_COOL in Cool Mode. In case of any Auto Change Over mode you can use V_HVAC_SETPOINT_HEAT as well as V_HVAC_SETPOINT_COOL to set the both the low bound and the high bound temperature of the device.</p>
<p>You can use V_HVAC_SPEED to control the Speed setting of the Fan in the HVAC.</p>
<p>You can use V_TEMP to send the current temperature from the node to Home Assistant.</p>
<h3>Climate example sketch for MySensors 2.x <a class="title-link" name="climate-example-sketch-for-mysensors-2x" href="#climate-example-sketch-for-mysensors-2x"></a>
</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="cpp"><span class="cm">/*
 * Documentation: https://www.mysensors.org
 * Support Forum: https://forum.mysensors.org
 */</span>

<span class="c1">// Enable debug prints to serial monitor</span>
<span class="cp">#define MY_DEBUG
#define MY_RADIO_NRF24
</span>
<span class="cp">#include</span> <span class="cpf">&lt;MySensors.h&gt;</span><span class="c1"> // sketch tested with version 2.3.2</span><span class="cp">
</span>
<span class="cp">#define SENSOR_NAME "Heatpump Sensor"
#define SENSOR_VERSION "2.3"
</span>
<span class="cp">#define CHILD_ID_HVAC 0
</span>
<span class="cp">#define IR_PIN  3  // Arduino pin tied to the IR led using Arduino PWM
</span>

<span class="c1">// Uncomment your heatpump model</span>
<span class="c1">//#include &lt;FujitsuHeatpumpIR.h&gt;</span>
<span class="c1">//#include &lt;PanasonicCKPHeatpumpIR.h&gt;</span>
<span class="c1">//#include &lt;PanasonicHeatpumpIR.h&gt;</span>
<span class="c1">//#include &lt;CarrierHeatpumpIR.h&gt;</span>
<span class="c1">//#include &lt;MideaHeatpumpIR.h&gt;</span>
<span class="c1">//#include &lt;MitsubishiHeatpumpIR.h&gt;</span>
<span class="c1">//#include &lt;SamsungHeatpumpIR.h&gt; // sketch tested with version 1.0.15, see http://librarymanager#HeatpumpIR by Toni Arte</span>
<span class="c1">//#include &lt;SharpHeatpumpIR.h&gt;</span>
<span class="c1">//#include &lt;DaikinHeatpumpIR.h&gt;</span>

<span class="c1">//Some global variables to hold the numeric states sent to the airco unit</span>
<span class="kt">int</span> <span class="n">POWER_STATE</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">TEMP_STATE</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">FAN_STATE</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">MODE_STATE</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">VDIR_STATE</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">HDIR_STATE</span><span class="p">;</span>

<span class="c1">//Some global variables to hold the text states sent to the home assistant controller</span>
<span class="n">String</span> <span class="n">FAN_STATE_TXT</span><span class="p">;</span>  <span class="c1">// possible values ("Min", "Normal", "Max", "Auto")</span>
<span class="n">String</span> <span class="n">MODE_STATE_TXT</span><span class="p">;</span> <span class="c1">// possible values ("Off", "HeatOn", "CoolOn", or "AutoChangeOver")</span>


<span class="n">IRSenderPWM</span> <span class="nf">irSender</span><span class="p">(</span><span class="n">IR_PIN</span><span class="p">);</span>

<span class="c1">//Change to your own Heatpump</span>
<span class="c1">//HeatpumpIR *heatpumpIR = new SamsungAQV12MSANHeatpumpIR();</span>
<span class="cm">/*
new PanasonicDKEHeatpumpIR()
new PanasonicJKEHeatpumpIR()
new PanasonicNKEHeatpumpIR()
new CarrierHeatpumpIR()
new MideaHeatpumpIR()
new FujitsuHeatpumpIR()
new MitsubishiFDHeatpumpIR()
new MitsubishiFEHeatpumpIR()
new SamsungAQVHeatpumpIR()
new SamsungFJMHeatpumpIR()
// new SamsungHeatpumpIR() is a protected generic method, cannot be created directly
new SharpHeatpumpIR()
new DaikinHeatpumpIR()
*/</span>

<span class="n">MyMessage</span> <span class="nf">msgHVACSetPointC</span><span class="p">(</span><span class="n">CHILD_ID_HVAC</span><span class="p">,</span> <span class="n">V_HVAC_SETPOINT_COOL</span><span class="p">);</span>
<span class="n">MyMessage</span> <span class="nf">msgHVACSpeed</span><span class="p">(</span><span class="n">CHILD_ID_HVAC</span><span class="p">,</span> <span class="n">V_HVAC_SPEED</span><span class="p">);</span>
<span class="n">MyMessage</span> <span class="nf">msgHVACFlowState</span><span class="p">(</span><span class="n">CHILD_ID_HVAC</span><span class="p">,</span> <span class="n">V_HVAC_FLOW_STATE</span><span class="p">);</span>

<span class="kt">bool</span> <span class="n">initialValueSent</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">presentation</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Send the sketch version information to the gateway and Controller</span>
  <span class="n">sendSketchInfo</span><span class="p">(</span><span class="n">SENSOR_NAME</span><span class="p">,</span> <span class="n">SENSOR_VERSION</span><span class="p">);</span>

  <span class="c1">// Register all sensors to gw (they will be created as child devices) by their ID and S_TYPE</span>
  <span class="n">present</span><span class="p">(</span><span class="n">CHILD_ID_HVAC</span><span class="p">,</span> <span class="n">S_HVAC</span><span class="p">,</span> <span class="s">"Thermostat"</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// put your main code here, to run repeatedly:</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">initialValueSent</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">FAN_STATE_TXT</span> <span class="o">=</span> <span class="s">"Auto"</span><span class="p">;</span> <span class="c1">// default fan start state</span>
    <span class="n">TEMP_STATE</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span> <span class="c1">// default start temperature</span>
    <span class="n">MODE_STATE_TXT</span> <span class="o">=</span> <span class="s">"Off"</span><span class="p">;</span> <span class="c1">// default mode state</span>

    <span class="n">send</span><span class="p">(</span><span class="n">msgHVACSetPointC</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">TEMP_STATE</span><span class="p">));</span>
    <span class="n">send</span><span class="p">(</span><span class="n">msgHVACSpeed</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">FAN_STATE_TXT</span><span class="p">.</span><span class="n">c_str</span><span class="p">()));</span>
    <span class="n">send</span><span class="p">(</span><span class="n">msgHVACFlowState</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">MODE_STATE_TXT</span><span class="p">.</span><span class="n">c_str</span><span class="p">()));</span>

    <span class="n">initialValueSent</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">receive</span><span class="p">(</span><span class="k">const</span> <span class="n">MyMessage</span> <span class="o">&amp;</span><span class="n">message</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">isAck</span><span class="p">())</span> <span class="p">{</span>
     <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"This is an ack from gateway"</span><span class="p">);</span>
     <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"Incoming message for: "</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">sensor</span><span class="p">);</span>

  <span class="n">String</span> <span class="n">recvData</span> <span class="o">=</span> <span class="n">message</span><span class="p">.</span><span class="n">data</span><span class="p">;</span>
  <span class="n">recvData</span><span class="p">.</span><span class="n">trim</span><span class="p">();</span>

  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">", New status: "</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">recvData</span><span class="p">);</span>
  <span class="k">switch</span> <span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">type</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="n">V_HVAC_SPEED</span><span class="p">:</span>
      <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"V_HVAC_SPEED"</span><span class="p">);</span>

      <span class="k">if</span><span class="p">(</span><span class="n">recvData</span><span class="p">.</span><span class="n">equalsIgnoreCase</span><span class="p">(</span><span class="s">"auto"</span><span class="p">))</span> <span class="n">FAN_STATE</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">recvData</span><span class="p">.</span><span class="n">equalsIgnoreCase</span><span class="p">(</span><span class="s">"min"</span><span class="p">))</span> <span class="n">FAN_STATE</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
      <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">recvData</span><span class="p">.</span><span class="n">equalsIgnoreCase</span><span class="p">(</span><span class="s">"normal"</span><span class="p">))</span> <span class="n">FAN_STATE</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
      <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">recvData</span><span class="p">.</span><span class="n">equalsIgnoreCase</span><span class="p">(</span><span class="s">"max"</span><span class="p">))</span> <span class="n">FAN_STATE</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
      <span class="n">FAN_STATE_TXT</span> <span class="o">=</span> <span class="n">recvData</span><span class="p">;</span>
    <span class="k">break</span><span class="p">;</span>

    <span class="k">case</span> <span class="n">V_HVAC_SETPOINT_COOL</span><span class="p">:</span>
      <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"V_HVAC_SETPOINT_COOL"</span><span class="p">);</span>
      <span class="n">TEMP_STATE</span> <span class="o">=</span> <span class="n">message</span><span class="p">.</span><span class="n">getFloat</span><span class="p">();</span>
      <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">TEMP_STATE</span><span class="p">);</span>
    <span class="k">break</span><span class="p">;</span>

    <span class="k">case</span> <span class="n">V_HVAC_FLOW_STATE</span><span class="p">:</span>
      <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"V_HVAC_FLOW_STATE"</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">recvData</span><span class="p">.</span><span class="n">equalsIgnoreCase</span><span class="p">(</span><span class="s">"coolon"</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">POWER_STATE</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">MODE_STATE</span> <span class="o">=</span> <span class="n">MODE_COOL</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">recvData</span><span class="p">.</span><span class="n">equalsIgnoreCase</span><span class="p">(</span><span class="s">"heaton"</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">POWER_STATE</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">MODE_STATE</span> <span class="o">=</span> <span class="n">MODE_HEAT</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">recvData</span><span class="p">.</span><span class="n">equalsIgnoreCase</span><span class="p">(</span><span class="s">"autochangeover"</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">POWER_STATE</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">MODE_STATE</span> <span class="o">=</span> <span class="n">MODE_AUTO</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">recvData</span><span class="p">.</span><span class="n">equalsIgnoreCase</span><span class="p">(</span><span class="s">"off"</span><span class="p">)){</span>
        <span class="n">POWER_STATE</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="n">MODE_STATE_TXT</span> <span class="o">=</span> <span class="n">recvData</span><span class="p">;</span>
      <span class="k">break</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">sendHeatpumpCommand</span><span class="p">();</span>
  <span class="n">sendNewStateToGateway</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">sendNewStateToGateway</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Status update send to HA:"</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"*************************"</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Mode = "</span> <span class="o">+</span> <span class="n">MODE_STATE_TXT</span> <span class="o">+</span> <span class="s">"("</span> <span class="o">+</span> <span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="n">MODE_STATE</span> <span class="o">+</span> <span class="s">")"</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Fan = "</span> <span class="o">+</span> <span class="n">FAN_STATE_TXT</span> <span class="o">+</span> <span class="s">"("</span> <span class="o">+</span> <span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="n">FAN_STATE</span> <span class="o">+</span> <span class="s">")"</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Temp = "</span> <span class="o">+</span> <span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="n">TEMP_STATE</span><span class="p">);</span>
  <span class="n">send</span><span class="p">(</span><span class="n">msgHVACFlowState</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">MODE_STATE_TXT</span><span class="p">.</span><span class="n">c_str</span><span class="p">()));</span>
  <span class="n">send</span><span class="p">(</span><span class="n">msgHVACSpeed</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">FAN_STATE_TXT</span><span class="p">.</span><span class="n">c_str</span><span class="p">()));</span>
  <span class="n">send</span><span class="p">(</span><span class="n">msgHVACSetPointC</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">TEMP_STATE</span><span class="p">));</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">sendHeatpumpCommand</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Heatpump commands send to airco:"</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"********************************"</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Power = "</span> <span class="o">+</span> <span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="n">POWER_STATE</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Mode = "</span> <span class="o">+</span> <span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="n">MODE_STATE</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Fan = "</span> <span class="o">+</span> <span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="n">FAN_STATE</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Temp = "</span> <span class="o">+</span> <span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="n">TEMP_STATE</span><span class="p">);</span>

  <span class="n">heatpumpIR</span><span class="o">-&gt;</span><span class="n">send</span><span class="p">(</span><span class="n">irSender</span><span class="p">,</span> <span class="n">POWER_STATE</span><span class="p">,</span> <span class="n">MODE_STATE</span><span class="p">,</span> <span class="n">FAN_STATE</span><span class="p">,</span> <span class="n">TEMP_STATE</span><span class="p">,</span> <span class="n">VDIR_AUTO</span><span class="p">,</span> <span class="n">HDIR_AUTO</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>
<h2>Cover <a class="title-link" name="cover" href="#cover"></a>
</h2>
<p>The following actuator types are supported:</p>
<h3>MySensors version 1.4 <a class="title-link" name="mysensors-version-14" href="#mysensors-version-14"></a>
</h3>
<table>
<thead>
<tr>
<th>S_TYPE</th>
<th>V_TYPE</th>
</tr>
</thead>
<tbody>
<tr>
<td>S_COVER</td>
<td>V_UP, V_DOWN, V_STOP, [V_DIMMER or V_LIGHT]</td>
</tr>
</tbody>
</table>
<h3>MySensors version 1.5 and higher <a class="title-link" name="mysensors-version-15-and-higher-2" href="#mysensors-version-15-and-higher-2"></a>
</h3>
<table>
<thead>
<tr>
<th>S_TYPE</th>
<th>V_TYPE</th>
</tr>
</thead>
<tbody>
<tr>
<td>S_COVER</td>
<td>V_UP, V_DOWN, V_STOP, [V_PERCENTAGE or V_STATUS]</td>
</tr>
</tbody>
</table>
<p>All V_TYPES above are required. Use V_PERCENTAGE (or V_DIMMER) if you know the exact position of the cover in percent, use V_STATUS (or V_LIGHT) if you donâ€™t.</p>
<h3>Cover example sketch <a class="title-link" name="cover-example-sketch" href="#cover-example-sketch"></a>
</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="cpp"><span class="cm">/*
 * Documentation: https://www.mysensors.org
 * Support Forum: https://forum.mysensors.org
 */</span>

<span class="c1">// Enable debug prints to serial monitor</span>
<span class="cp">#define MY_DEBUG
#define MY_RADIO_NRF24
</span>
<span class="cp">#include</span> <span class="cpf">&lt;MySensors.h&gt;</span><span class="cp">
</span>
<span class="cp">#define SN "Cover"
#define SV "1.1"
</span>
<span class="c1">// Actuators for moving the cover up and down respectively.</span>
<span class="cp">#define COVER_UP_ACTUATOR_PIN 2
#define COVER_DOWN_ACTUATOR_PIN 3
</span><span class="c1">// Sensors for finding out when the cover has reached its up/down position.</span>
<span class="c1">// These could be simple buttons or linear hall sensors.</span>
<span class="cp">#define COVER_UP_SENSOR_PIN 4
#define COVER_DOWN_SENSOR_PIN 5
</span>
<span class="cp">#define CHILD_ID 0
</span>
<span class="c1">// Internal representation of the cover state.</span>
<span class="k">enum</span> <span class="n">State</span> <span class="p">{</span>
  <span class="n">IDLE</span><span class="p">,</span>
  <span class="n">UP</span><span class="p">,</span> <span class="c1">// Window covering. Up.</span>
  <span class="n">DOWN</span><span class="p">,</span> <span class="c1">// Window covering. Down.</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">int</span> <span class="n">state</span> <span class="o">=</span> <span class="n">IDLE</span><span class="p">;</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">status</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// 0=cover is down, 1=cover is up</span>
<span class="k">static</span> <span class="kt">bool</span> <span class="n">initial_state_sent</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
<span class="n">MyMessage</span> <span class="nf">upMessage</span><span class="p">(</span><span class="n">CHILD_ID</span><span class="p">,</span> <span class="n">V_UP</span><span class="p">);</span>
<span class="n">MyMessage</span> <span class="nf">downMessage</span><span class="p">(</span><span class="n">CHILD_ID</span><span class="p">,</span> <span class="n">V_DOWN</span><span class="p">);</span>
<span class="n">MyMessage</span> <span class="nf">stopMessage</span><span class="p">(</span><span class="n">CHILD_ID</span><span class="p">,</span> <span class="n">V_STOP</span><span class="p">);</span>
<span class="n">MyMessage</span> <span class="nf">statusMessage</span><span class="p">(</span><span class="n">CHILD_ID</span><span class="p">,</span> <span class="n">V_STATUS</span><span class="p">);</span>

<span class="kt">void</span> <span class="nf">sendState</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Send current state and status to gateway.</span>
  <span class="n">send</span><span class="p">(</span><span class="n">upMessage</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">state</span> <span class="o">==</span> <span class="n">UP</span><span class="p">));</span>
  <span class="n">send</span><span class="p">(</span><span class="n">downMessage</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">state</span> <span class="o">==</span> <span class="n">DOWN</span><span class="p">));</span>
  <span class="n">send</span><span class="p">(</span><span class="n">stopMessage</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">state</span> <span class="o">==</span> <span class="n">IDLE</span><span class="p">));</span>
  <span class="n">send</span><span class="p">(</span><span class="n">statusMessage</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">status</span><span class="p">));</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">pinMode</span><span class="p">(</span><span class="n">COVER_UP_SENSOR_PIN</span><span class="p">,</span> <span class="n">INPUT</span><span class="p">);</span>
  <span class="n">pinMode</span><span class="p">(</span><span class="n">COVER_DOWN_SENSOR_PIN</span><span class="p">,</span> <span class="n">INPUT</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">presentation</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">sendSketchInfo</span><span class="p">(</span><span class="n">SN</span><span class="p">,</span> <span class="n">SV</span><span class="p">);</span>

  <span class="n">present</span><span class="p">(</span><span class="n">CHILD_ID</span><span class="p">,</span> <span class="n">S_COVER</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">initial_state_sent</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">sendState</span><span class="p">();</span>
    <span class="n">initial_state_sent</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">state</span> <span class="o">==</span> <span class="n">IDLE</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">digitalWrite</span><span class="p">(</span><span class="n">COVER_UP_ACTUATOR_PIN</span><span class="p">,</span> <span class="n">LOW</span><span class="p">);</span>
    <span class="n">digitalWrite</span><span class="p">(</span><span class="n">COVER_DOWN_ACTUATOR_PIN</span><span class="p">,</span> <span class="n">LOW</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">state</span> <span class="o">==</span> <span class="n">UP</span> <span class="o">&amp;&amp;</span> <span class="n">digitalRead</span><span class="p">(</span><span class="n">COVER_UP_SENSOR_PIN</span><span class="p">)</span> <span class="o">==</span> <span class="n">HIGH</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Cover is up."</span><span class="p">);</span>
    <span class="c1">// Update status and state; send it to the gateway.</span>
    <span class="n">status</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">IDLE</span><span class="p">;</span>
    <span class="n">sendState</span><span class="p">();</span>
    <span class="c1">// Actuators will be disabled in next loop() iteration.</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">state</span> <span class="o">==</span> <span class="n">DOWN</span> <span class="o">&amp;&amp;</span> <span class="n">digitalRead</span><span class="p">(</span><span class="n">COVER_DOWN_SENSOR_PIN</span><span class="p">)</span> <span class="o">==</span> <span class="n">HIGH</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Cover is down."</span><span class="p">);</span>
    <span class="c1">// Update status and state; send it to the gateway.</span>
    <span class="n">status</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">IDLE</span><span class="p">;</span>
    <span class="n">sendState</span><span class="p">();</span>
    <span class="c1">// Actuators will be disabled in next loop() iteration.</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">receive</span><span class="p">(</span><span class="k">const</span> <span class="n">MyMessage</span> <span class="o">&amp;</span><span class="n">message</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">V_UP</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Set state to covering up and send it back to the gateway.</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">UP</span><span class="p">;</span>
    <span class="n">sendState</span><span class="p">();</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Moving cover up."</span><span class="p">);</span>

    <span class="c1">// Activate actuator until the sensor returns HIGH in loop().</span>
    <span class="n">digitalWrite</span><span class="p">(</span><span class="n">COVER_UP_ACTUATOR_PIN</span><span class="p">,</span> <span class="n">HIGH</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">V_DOWN</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Set state to covering up and send it back to the gateway.</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">DOWN</span><span class="p">;</span>
    <span class="n">sendState</span><span class="p">();</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Moving cover down."</span><span class="p">);</span>
    <span class="c1">// Activate actuator until the sensor returns HIGH in loop().</span>
    <span class="n">digitalWrite</span><span class="p">(</span><span class="n">COVER_DOWN_ACTUATOR_PIN</span><span class="p">,</span> <span class="n">HIGH</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">V_STOP</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Set state to idle and send it back to the gateway.</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">IDLE</span><span class="p">;</span>
    <span class="n">sendState</span><span class="p">();</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Stopping cover."</span><span class="p">);</span>

    <span class="c1">// Actuators will be switched off in loop().</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<h4>Cover sketch example with position measurement based on motor running time <a class="title-link" name="cover-sketch-example-with-position-measurement-based-on-motor-running-time" href="#cover-sketch-example-with-position-measurement-based-on-motor-running-time"></a>
</h4>
<p>This sketch is ideally for star topology wiring. You can run up to 12 covers with a single Arduino Mega board and some relays. All you need to set is one line of parameters for one Cover. However, you can also use it for a single cover based on an Arduino Nano or even an ESP8266 board.</p>
<p><a href="https://github.com/gryzli133/RollerShutterSplit" rel="external nofollow">Check out the code on GitHub.<iconify-icon inline="true" icon="tabler:external-link" class="external-link"></iconify-icon></a></p>
<h2>Device tracker <a class="title-link" name="device-tracker" href="#device-tracker"></a>
</h2>
<p>The following sensor types are supported:</p>
<h3>MySensors version 2.0 and higher <a class="title-link" name="mysensors-version-20-and-higher" href="#mysensors-version-20-and-higher"></a>
</h3>
<table>
<thead>
<tr>
<th>S_TYPE</th>
<th>V_TYPE</th>
</tr>
</thead>
<tbody>
<tr>
<td>S_GPS</td>
<td>V_POSITION</td>
</tr>
</tbody>
</table>
<h3>Device tracker example sketch for MySensors 2.x <a class="title-link" name="device-tracker-example-sketch-for-mysensors-2x" href="#device-tracker-example-sketch-for-mysensors-2x"></a>
</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="cpp"><span class="cm">/**
 * Documentation: https://www.mysensors.org
 * Support Forum: https://forum.mysensors.org
 *
 * https://www.mysensors.org/build/gps
 */</span>

<span class="c1">// Enable debug prints to serial monitor</span>
<span class="cp">#define MY_DEBUG
#define MY_RADIO_NRF24
</span>
<span class="cp">#include</span> <span class="cpf">&lt;MySensors.h&gt;</span><span class="cp">
</span>
<span class="cp">#define SN "GPS Sensor"
#define SV "1.0"
</span>
<span class="c1">// GPS position send interval (in milliseconds)</span>
<span class="cp">#define GPS_SEND_INTERVAL 30000
</span><span class="c1">// The child id used for the gps sensor</span>
<span class="cp">#define CHILD_ID_GPS 1
</span>
<span class="n">MyMessage</span> <span class="nf">msg</span><span class="p">(</span><span class="n">CHILD_ID_GPS</span><span class="p">,</span> <span class="n">V_POSITION</span><span class="p">);</span>

<span class="c1">// Last time GPS position was sent to controller</span>
<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">lastGPSSent</span> <span class="o">=</span> <span class="o">-</span><span class="mi">31000</span><span class="p">;</span>

<span class="c1">// Some buffers</span>
<span class="kt">char</span> <span class="n">latBuf</span><span class="p">[</span><span class="mi">11</span><span class="p">];</span>
<span class="kt">char</span> <span class="n">lngBuf</span><span class="p">[</span><span class="mi">11</span><span class="p">];</span>
<span class="kt">char</span> <span class="n">altBuf</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
<span class="kt">char</span> <span class="n">payload</span><span class="p">[</span><span class="mi">30</span><span class="p">];</span>

<span class="c1">// Dummy values. Implementation of real GPS device is not done.</span>
<span class="kt">float</span> <span class="n">gpsLocationLat</span> <span class="o">=</span> <span class="mf">40.741895</span><span class="p">;</span>
<span class="kt">float</span> <span class="n">gpsLocationLng</span> <span class="o">=</span> <span class="o">-</span><span class="mf">73.989308</span><span class="p">;</span>
<span class="kt">float</span> <span class="n">gpsAltitudeMeters</span> <span class="o">=</span> <span class="mf">12.0</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>

<span class="p">}</span>

<span class="kt">void</span> <span class="nf">presentation</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">sendSketchInfo</span><span class="p">(</span><span class="n">SN</span><span class="p">,</span> <span class="n">SV</span><span class="p">);</span>
  <span class="n">present</span><span class="p">(</span><span class="n">CHILD_ID_GPS</span><span class="p">,</span> <span class="n">S_GPS</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">currentTime</span> <span class="o">=</span> <span class="n">millis</span><span class="p">();</span>

  <span class="c1">// Evaluate if it is time to send a new position</span>
  <span class="kt">bool</span> <span class="n">timeToSend</span> <span class="o">=</span> <span class="n">currentTime</span> <span class="o">-</span> <span class="n">lastGPSSent</span> <span class="o">&gt;</span> <span class="n">GPS_SEND_INTERVAL</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">timeToSend</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Send current gps location</span>
    <span class="c1">// Build position and altitude string to send</span>
    <span class="n">dtostrf</span><span class="p">(</span><span class="n">gpsLocationLat</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">latBuf</span><span class="p">);</span>
    <span class="n">dtostrf</span><span class="p">(</span><span class="n">gpsLocationLng</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">lngBuf</span><span class="p">);</span>
    <span class="n">dtostrf</span><span class="p">(</span><span class="n">gpsAltitudeMeters</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">altBuf</span><span class="p">);</span>
    <span class="n">sprintf</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="s">"%s,%s,%s"</span><span class="p">,</span> <span class="n">latBuf</span><span class="p">,</span> <span class="n">lngBuf</span><span class="p">,</span> <span class="n">altBuf</span><span class="p">);</span>

    <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="s">"Position: "</span><span class="p">));</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">payload</span><span class="p">);</span>

    <span class="n">send</span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">payload</span><span class="p">));</span>
    <span class="n">lastGPSSent</span> <span class="o">=</span> <span class="n">currentTime</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<h2>Light <a class="title-link" name="light" href="#light"></a>
</h2>
<p>The following actuator types are supported:</p>
<h3>MySensors version 1.4 <a class="title-link" name="mysensors-version-14-1" href="#mysensors-version-14-1"></a>
</h3>
<table>
<thead>
<tr>
<th>S_TYPE</th>
<th>V_TYPE</th>
</tr>
</thead>
<tbody>
<tr>
<td>S_DIMMER</td>
<td>V_DIMMER*, V_LIGHT*</td>
</tr>
</tbody>
</table>
<h3>MySensors version 1.5 and higher <a class="title-link" name="mysensors-version-15-and-higher-3" href="#mysensors-version-15-and-higher-3"></a>
</h3>
<table>
<thead>
<tr>
<th>S_TYPE</th>
<th>V_TYPE</th>
</tr>
</thead>
<tbody>
<tr>
<td>S_DIMMER</td>
<td>[V_DIMMER* or V_PERCENTAGE*], [V_LIGHT* or V_STATUS*]</td>
</tr>
<tr>
<td>S_RGB_LIGHT</td>
<td>V_RGB*, [V_LIGHT* or V_STATUS*], [V_DIMMER or V_PERCENTAGE]</td>
</tr>
<tr>
<td>S_RGBW_LIGHT</td>
<td>V_RGBW*, [V_LIGHT* or V_STATUS*], [V_DIMMER or V_PERCENTAGE]</td>
</tr>
</tbody>
</table>
<p>V_TYPES with a star (*) denote V_TYPES that should be sent at sketch startup. For an S_DIMMER, send both a V_DIMMER/V_PERCENTAGE and a V_LIGHT/V_STATUS message.  For an S_RGB_LIGHT, send both a V_RGB and a V_LIGHT/V_STATUS message with a V_DIMMER/V_PERCENTAGE message being optional. Same principal applies for S_RGBW_LIGHT and V_RGBW.</p>
<p>Sketch should acknowledge a command sent from controller with the same type.  If command invokes a change to off state (including a V_PERCENTAGE, V_RGB, or V_RGBW message of zero), only a V_STATUS of zero message should be sent.  See sketches below for examples.</p>
<h4>Light example sketch for MySensors 2.x <a class="title-link" name="light-example-sketch-for-mysensors-2x" href="#light-example-sketch-for-mysensors-2x"></a>
</h4>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="cpp"><span class="cm">/*
 * Example Dimmable Light
 * Code adapted from https://github.com/mysensors/MySensors/tree/master/examples/DimmableLight
 *
 * Documentation: https://www.mysensors.org
 * Support Forum: https://forum.mysensors.org
 *
 */</span>

<span class="c1">// Enable debug prints</span>
<span class="cp">#define MY_DEBUG
#define MY_RADIO_NRF24
</span>
<span class="cp">#include</span> <span class="cpf">&lt;MySensors.h&gt;</span><span class="cp">
</span>
<span class="cp">#define CHILD_ID_LIGHT 1
</span>
<span class="cp">#define LIGHT_OFF 0
#define LIGHT_ON 1
</span>
<span class="cp">#define SN "Dimmable Light"
#define SV "1.0"
</span>
<span class="kt">int16_t</span> <span class="n">last_state</span> <span class="o">=</span> <span class="n">LIGHT_ON</span><span class="p">;</span>
<span class="kt">int16_t</span> <span class="n">last_dim</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>

<span class="n">MyMessage</span> <span class="nf">light_msg</span><span class="p">(</span> <span class="n">CHILD_ID_LIGHT</span><span class="p">,</span> <span class="n">V_STATUS</span> <span class="p">);</span>
<span class="n">MyMessage</span> <span class="nf">dimmer_msg</span><span class="p">(</span> <span class="n">CHILD_ID_LIGHT</span><span class="p">,</span> <span class="n">V_PERCENTAGE</span> <span class="p">);</span>

<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">update_light</span><span class="p">();</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span> <span class="s">"Node ready to receive messages..."</span> <span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span>
<span class="p">{</span>
  <span class="c1">//In MySensors2.x, first message must come from within loop()</span>
  <span class="k">static</span> <span class="kt">bool</span> <span class="n">first_message_sent</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">first_message_sent</span> <span class="o">==</span> <span class="nb">false</span> <span class="p">)</span> <span class="p">{</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span> <span class="s">"Sending initial state..."</span> <span class="p">);</span>
    <span class="n">send_dimmer_message</span><span class="p">();</span>
    <span class="n">send_status_message</span><span class="p">();</span>
    <span class="n">first_message_sent</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">presentation</span><span class="p">()</span>
<span class="p">{</span>
  <span class="c1">// Send the sketch version information to the gateway</span>
  <span class="n">sendSketchInfo</span><span class="p">(</span> <span class="n">SN</span><span class="p">,</span> <span class="n">SV</span> <span class="p">);</span>
  <span class="n">present</span><span class="p">(</span> <span class="n">CHILD_ID_LIGHT</span><span class="p">,</span> <span class="n">S_DIMMER</span> <span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">receive</span><span class="p">(</span><span class="k">const</span> <span class="n">MyMessage</span> <span class="o">&amp;</span><span class="n">message</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">//When receiving a V_STATUS command, switch the light between OFF</span>
  <span class="c1">//and the last received dimmer value</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">message</span><span class="p">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">V_STATUS</span> <span class="p">)</span> <span class="p">{</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span> <span class="s">"V_STATUS command received..."</span> <span class="p">);</span>

    <span class="kt">int</span> <span class="n">lstate</span> <span class="o">=</span> <span class="n">message</span><span class="p">.</span><span class="n">getInt</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">((</span> <span class="n">lstate</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="o">||</span> <span class="p">(</span> <span class="n">lstate</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="p">))</span> <span class="p">{</span>
      <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span> <span class="s">"V_STATUS data invalid (should be 0/1)"</span> <span class="p">);</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">last_state</span> <span class="o">=</span> <span class="n">lstate</span><span class="p">;</span>

    <span class="c1">//If last dimmer state is zero, set dimmer to 100</span>
    <span class="k">if</span> <span class="p">((</span> <span class="n">last_state</span> <span class="o">==</span> <span class="n">LIGHT_ON</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span> <span class="n">last_dim</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">))</span> <span class="p">{</span>
      <span class="n">last_dim</span><span class="o">=</span><span class="mi">100</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">//Update constroller status</span>
    <span class="n">send_status_message</span><span class="p">();</span>

  <span class="p">}</span> <span class="k">else</span> <span class="nf">if</span> <span class="p">(</span> <span class="n">message</span><span class="p">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">V_PERCENTAGE</span> <span class="p">)</span> <span class="p">{</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span> <span class="s">"V_PERCENTAGE command received..."</span> <span class="p">);</span>
    <span class="kt">int</span> <span class="n">dim_value</span> <span class="o">=</span> <span class="n">constrain</span><span class="p">(</span> <span class="n">message</span><span class="p">.</span><span class="n">getInt</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span> <span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">dim_value</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span>
      <span class="n">last_state</span> <span class="o">=</span> <span class="n">LIGHT_OFF</span><span class="p">;</span>

      <span class="c1">//Update constroller with dimmer value &amp; status</span>
      <span class="n">send_dimmer_message</span><span class="p">();</span>
      <span class="n">send_status_message</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">last_state</span> <span class="o">=</span> <span class="n">LIGHT_ON</span><span class="p">;</span>
      <span class="n">last_dim</span> <span class="o">=</span> <span class="n">dim_value</span><span class="p">;</span>

      <span class="c1">//Update constroller with dimmer value</span>
      <span class="n">send_dimmer_message</span><span class="p">();</span>
    <span class="p">}</span>

  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span> <span class="s">"Invalid command received..."</span> <span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">//Here you set the actual light state/level</span>
  <span class="n">update_light</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">update_light</span><span class="p">()</span>
<span class="p">{</span>
  <span class="c1">//For this example, just print the light status to console.</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">last_state</span> <span class="o">==</span> <span class="n">LIGHT_OFF</span> <span class="p">)</span> <span class="p">{</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span> <span class="s">"Light state: OFF"</span> <span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span> <span class="s">"Light state: ON, Level: "</span> <span class="p">);</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span> <span class="n">last_dim</span> <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">send_dimmer_message</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">send</span><span class="p">(</span> <span class="n">dimmer_msg</span><span class="p">.</span><span class="n">set</span><span class="p">(</span> <span class="n">last_dim</span> <span class="p">)</span> <span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">send_status_message</span><span class="p">()</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">last_state</span> <span class="o">==</span> <span class="n">LIGHT_OFF</span> <span class="p">)</span> <span class="p">{</span>
    <span class="n">send</span><span class="p">(</span> <span class="n">light_msg</span><span class="p">.</span><span class="n">set</span><span class="p">(</span> <span class="p">(</span><span class="kt">int16_t</span><span class="p">)</span><span class="mi">0</span><span class="p">)</span> <span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="n">send</span><span class="p">(</span> <span class="n">light_msg</span><span class="p">.</span><span class="n">set</span><span class="p">(</span> <span class="p">(</span><span class="kt">int16_t</span><span class="p">)</span><span class="mi">1</span><span class="p">)</span> <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<h2>Remote <a class="title-link" name="remote" href="#remote"></a>
</h2>
<p>The following type combinations are supported:</p>
<h3>MySensors version 1.4 and higher <a class="title-link" name="mysensors-version-14-and-higher-1" href="#mysensors-version-14-and-higher-1"></a>
</h3>
<table>
<thead>
<tr>
<th>S_TYPE</th>
<th>V_TYPE</th>
</tr>
</thead>
<tbody>
<tr>
<td>S_IR</td>
<td>V_IR_SEND, V_LIGHT</td>
</tr>
</tbody>
</table>
<h3>MySensors version 1.5 and higher <a class="title-link" name="mysensors-version-15-and-higher-4" href="#mysensors-version-15-and-higher-4"></a>
</h3>
<table>
<thead>
<tr>
<th>S_TYPE</th>
<th>V_TYPE</th>
</tr>
</thead>
<tbody>
<tr>
<td>S_IR</td>
<td>V_IR_SEND, V_STATUS</td>
</tr>
</tbody>
</table>
<p>V_LIGHT or V_STATUS is required to report the on / off state of the remote. Use either V_LIGHT or V_STATUS depending on library version.</p>
<h3>IR transceiver example sketch <a class="title-link" name="ir-transceiver-example-sketch" href="#ir-transceiver-example-sketch"></a>
</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="cpp"><span class="cm">/*
 * Documentation: https://www.mysensors.org
 * Support Forum: https://forum.mysensors.org
 *
 * https://www.mysensors.org/build/ir
 */</span>

<span class="cp">#include</span> <span class="cpf">&lt;MySensor.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;SPI.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;IRLib.h&gt;</span><span class="cp">
</span>
<span class="cp">#define SN "IR Sensor"
#define SV "1.0"
#define CHILD_ID 1
</span>
<span class="n">MySensor</span> <span class="n">gw</span><span class="p">;</span>

<span class="kt">char</span> <span class="n">code</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="s">"abcd01234"</span><span class="p">;</span>
<span class="kt">char</span> <span class="n">oldCode</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="s">"abcd01234"</span><span class="p">;</span>
<span class="n">MyMessage</span> <span class="nf">msgCodeRec</span><span class="p">(</span><span class="n">CHILD_ID</span><span class="p">,</span> <span class="n">V_IR_RECEIVE</span><span class="p">);</span>
<span class="n">MyMessage</span> <span class="nf">msgCode</span><span class="p">(</span><span class="n">CHILD_ID</span><span class="p">,</span> <span class="n">V_IR_SEND</span><span class="p">);</span>
<span class="n">MyMessage</span> <span class="nf">msgSendCode</span><span class="p">(</span><span class="n">CHILD_ID</span><span class="p">,</span> <span class="n">V_LIGHT</span><span class="p">);</span>

<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">gw</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="n">incomingMessage</span><span class="p">);</span>
  <span class="n">gw</span><span class="p">.</span><span class="n">sendSketchInfo</span><span class="p">(</span><span class="n">SN</span><span class="p">,</span> <span class="n">SV</span><span class="p">);</span>
  <span class="n">gw</span><span class="p">.</span><span class="n">present</span><span class="p">(</span><span class="n">CHILD_ID</span><span class="p">,</span> <span class="n">S_IR</span><span class="p">);</span>
  <span class="c1">// Send initial values.</span>
  <span class="n">gw</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">msgCodeRec</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">code</span><span class="p">));</span>
  <span class="n">gw</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">msgCode</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">code</span><span class="p">));</span>
  <span class="n">gw</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">msgSendCode</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">gw</span><span class="p">.</span><span class="n">process</span><span class="p">();</span>
  <span class="c1">// IR receiver not implemented, just a dummy report of code when it changes</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="o">!=</span> <span class="n">String</span><span class="p">(</span><span class="n">oldCode</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"Code received "</span><span class="p">);</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">code</span><span class="p">);</span>
    <span class="n">gw</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">msgCodeRec</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">code</span><span class="p">));</span>
    <span class="n">strcpy</span><span class="p">(</span><span class="n">oldCode</span><span class="p">,</span> <span class="n">code</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">incomingMessage</span><span class="p">(</span><span class="k">const</span> <span class="n">MyMessage</span> <span class="o">&amp;</span><span class="n">message</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">type</span><span class="o">==</span><span class="n">V_LIGHT</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// IR sender not implemented, just a dummy print.</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">getBool</span><span class="p">())</span> <span class="p">{</span>
      <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"Sending code "</span><span class="p">);</span>
      <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">code</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">gw</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">msgSendCode</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">getBool</span><span class="p">()</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">));</span>
    <span class="c1">// Always turn off device</span>
    <span class="n">gw</span><span class="p">.</span><span class="n">wait</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
    <span class="n">gw</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">msgSendCode</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">V_IR_SEND</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Retrieve the IR code value from the incoming message.</span>
    <span class="n">String</span> <span class="n">codestring</span> <span class="o">=</span> <span class="n">message</span><span class="p">.</span><span class="n">getString</span><span class="p">();</span>
    <span class="n">codestring</span><span class="p">.</span><span class="n">toCharArray</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">code</span><span class="p">));</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"Changing code to "</span><span class="p">);</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">code</span><span class="p">);</span>
    <span class="n">gw</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">msgCode</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">code</span><span class="p">));</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<h2>Sensor <a class="title-link" name="sensor" href="#sensor"></a>
</h2>
<p>The following sensor types are supported:</p>
<h3>MySensors version 1.4 and higher <a class="title-link" name="mysensors-version-14-and-higher-2" href="#mysensors-version-14-and-higher-2"></a>
</h3>
<table>
<thead>
<tr>
<th>S_TYPE</th>
<th>V_TYPE</th>
</tr>
</thead>
<tbody>
<tr>
<td>S_TEMP</td>
<td>V_TEMP</td>
</tr>
<tr>
<td>S_HUM</td>
<td>V_HUM</td>
</tr>
<tr>
<td>S_BARO</td>
<td>V_PRESSURE, V_FORECAST</td>
</tr>
<tr>
<td>S_WIND</td>
<td>V_WIND, V_GUST, V_DIRECTION</td>
</tr>
<tr>
<td>S_RAIN</td>
<td>V_RAIN, V_RAINRATE</td>
</tr>
<tr>
<td>S_UV</td>
<td>V_UV</td>
</tr>
<tr>
<td>S_WEIGHT</td>
<td>V_WEIGHT, V_IMPEDANCE</td>
</tr>
<tr>
<td>S_POWER</td>
<td>V_WATT, V_KWH</td>
</tr>
<tr>
<td>S_DISTANCE</td>
<td>V_DISTANCE</td>
</tr>
<tr>
<td>S_LIGHT_LEVEL</td>
<td>V_LIGHT_LEVEL</td>
</tr>
<tr>
<td>S_IR</td>
<td>V_IR_RECEIVE</td>
</tr>
<tr>
<td>S_WATER</td>
<td>V_FLOW, V_VOLUME</td>
</tr>
<tr>
<td>S_AIR_QUALITY</td>
<td>V_DUST_LEVEL</td>
</tr>
<tr>
<td>S_CUSTOM</td>
<td>V_VAR1, V_VAR2, V_VAR3, V_VAR4, V_VAR5</td>
</tr>
<tr>
<td>S_DUST</td>
<td>V_DUST_LEVEL</td>
</tr>
<tr>
<td>S_SCENE_CONTROLLER</td>
<td>V_SCENE_ON, V_SCENE_OFF</td>
</tr>
</tbody>
</table>
<h4>MySensors version 1.5 and higher <a class="title-link" name="mysensors-version-15-and-higher-5" href="#mysensors-version-15-and-higher-5"></a>
</h4>
<table>
<thead>
<tr>
<th>S_TYPE</th>
<th>V_TYPE</th>
</tr>
</thead>
<tbody>
<tr>
<td>S_COLOR_SENSOR</td>
<td>V_RGB</td>
</tr>
<tr>
<td>S_MULTIMETER</td>
<td>V_VOLTAGE, V_CURRENT, V_IMPEDANCE</td>
</tr>
<tr>
<td>S_SOUND</td>
<td>V_LEVEL</td>
</tr>
<tr>
<td>S_VIBRATION</td>
<td>V_LEVEL</td>
</tr>
<tr>
<td>S_MOISTURE</td>
<td>V_LEVEL</td>
</tr>
<tr>
<td>S_LIGHT_LEVEL</td>
<td>V_LEVEL</td>
</tr>
<tr>
<td>S_AIR_QUALITY</td>
<td>V_LEVEL (replaces V_DUST_LEVEL)</td>
</tr>
<tr>
<td>S_DUST</td>
<td>V_LEVEL (replaces V_DUST_LEVEL)</td>
</tr>
</tbody>
</table>
<h3>MySensors version 2.0 and higher <a class="title-link" name="mysensors-version-20-and-higher-1" href="#mysensors-version-20-and-higher-1"></a>
</h3>
<table>
<thead>
<tr>
<th>S_TYPE</th>
<th>V_TYPE</th>
</tr>
</thead>
<tbody>
<tr>
<td>S_INFO</td>
<td>V_TEXT</td>
</tr>
<tr>
<td>S_GAS</td>
<td>V_FLOW, V_VOLUME</td>
</tr>
<tr>
<td>S_GPS</td>
<td>V_POSITION</td>
</tr>
<tr>
<td>S_IR</td>
<td>V_IR_RECORD</td>
</tr>
<tr>
<td>S_WATER_QUALITY</td>
<td>V_TEMP, V_PH, V_ORP, V_EC</td>
</tr>
</tbody>
</table>
<h3>Custom unit of measurement <a class="title-link" name="custom-unit-of-measurement" href="#custom-unit-of-measurement"></a>
</h3>
<p>Some sensor value types are not specific for a certain sensor type. These do not have a default unit of measurement in Home Assistant. For example, the V_LEVEL type can be used for different sensor types, dust, sound, vibration etc.</p>
<p>By using V_UNIT_PREFIX, itâ€™s possible to set a custom unit for any sensor. The string value that is sent for V_UNIT_PREFIX will be used in preference to any other unit of measurement, for the defined sensors. V_UNIT_PREFIX canâ€™t be used as a stand-alone sensor value type. Sending a supported value type and value from the tables above is also required. V_UNIT_PREFIX is available with MySensors version 1.5 and later.</p>
<h3>Sensor example sketch for MySensors 2.x <a class="title-link" name="sensor-example-sketch-for-mysensors-2x" href="#sensor-example-sketch-for-mysensors-2x"></a>
</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="cpp"><span class="cm">/**
 * Documentation: https://www.mysensors.org
 * Support Forum: https://forum.mysensors.org
 *
 * https://www.mysensors.org/build/light
 */</span>

<span class="c1">// Enable debug prints to serial monitor</span>
<span class="cp">#define MY_DEBUG
#define MY_RADIO_NRF24
</span>
<span class="cp">#include</span> <span class="cpf">&lt;BH1750.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;Wire.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;MySensors.h&gt;</span><span class="cp">
</span>
<span class="cp">#define SN "LightLuxSensor"
#define SV "1.0"
#define CHILD_ID 1
</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">SLEEP_TIME</span> <span class="o">=</span> <span class="mi">30000</span><span class="p">;</span> <span class="c1">// Sleep time between reads (in milliseconds)</span>

<span class="n">BH1750</span> <span class="n">lightSensor</span><span class="p">;</span>
<span class="n">MyMessage</span> <span class="nf">msg</span><span class="p">(</span><span class="n">CHILD_ID</span><span class="p">,</span> <span class="n">V_LEVEL</span><span class="p">);</span>
<span class="n">MyMessage</span> <span class="nf">msgPrefix</span><span class="p">(</span><span class="n">CHILD_ID</span><span class="p">,</span> <span class="n">V_UNIT_PREFIX</span><span class="p">);</span>  <span class="c1">// Custom unit message.</span>
<span class="kt">uint16_t</span> <span class="n">lastlux</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kt">bool</span> <span class="n">initialValueSent</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">sendSketchInfo</span><span class="p">(</span><span class="n">SN</span><span class="p">,</span> <span class="n">SV</span><span class="p">);</span>
  <span class="n">present</span><span class="p">(</span><span class="n">CHILD_ID</span><span class="p">,</span> <span class="n">S_LIGHT_LEVEL</span><span class="p">);</span>
  <span class="n">lightSensor</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">initialValueSent</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Sending initial value"</span><span class="p">);</span>
    <span class="n">send</span><span class="p">(</span><span class="n">msgPrefix</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="s">"custom_lux"</span><span class="p">));</span>  <span class="c1">// Set custom unit.</span>
    <span class="n">send</span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">lastlux</span><span class="p">));</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Requesting initial value from controller"</span><span class="p">);</span>
    <span class="n">request</span><span class="p">(</span><span class="n">CHILD_ID</span><span class="p">,</span> <span class="n">V_LEVEL</span><span class="p">);</span>
    <span class="n">wait</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="n">C_SET</span><span class="p">,</span> <span class="n">V_LEVEL</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="kt">uint16_t</span> <span class="n">lux</span> <span class="o">=</span> <span class="n">lightSensor</span><span class="p">.</span><span class="n">readLightLevel</span><span class="p">();</span>  <span class="c1">// Get Lux value</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">lux</span> <span class="o">!=</span> <span class="n">lastlux</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">send</span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">lux</span><span class="p">));</span>
      <span class="n">lastlux</span> <span class="o">=</span> <span class="n">lux</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">sleep</span><span class="p">(</span><span class="n">SLEEP_TIME</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">receive</span><span class="p">(</span><span class="k">const</span> <span class="n">MyMessage</span> <span class="o">&amp;</span><span class="n">message</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">V_LEVEL</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">initialValueSent</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Receiving initial value from controller"</span><span class="p">);</span>
      <span class="n">initialValueSent</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<h2>Switch <a class="title-link" name="switch" href="#switch"></a>
</h2>
<p>The following actuator types are supported:</p>
<h3>MySensors version 1.4 and higher <a class="title-link" name="mysensors-version-14-and-higher-3" href="#mysensors-version-14-and-higher-3"></a>
</h3>
<table>
<thead>
<tr>
<th>S_TYPE</th>
<th>V_TYPE</th>
</tr>
</thead>
<tbody>
<tr>
<td>S_DOOR</td>
<td>V_ARMED</td>
</tr>
<tr>
<td>S_MOTION</td>
<td>V_ARMED</td>
</tr>
<tr>
<td>S_SMOKE</td>
<td>V_ARMED</td>
</tr>
<tr>
<td>S_LIGHT</td>
<td>V_LIGHT</td>
</tr>
<tr>
<td>S_LOCK</td>
<td>V_LOCK_STATUS</td>
</tr>
</tbody>
</table>
<h3>MySensors version 1.5 and higher <a class="title-link" name="mysensors-version-15-and-higher-6" href="#mysensors-version-15-and-higher-6"></a>
</h3>
<table>
<thead>
<tr>
<th>S_TYPE</th>
<th>V_TYPE</th>
</tr>
</thead>
<tbody>
<tr>
<td>S_LIGHT</td>
<td>V_STATUS</td>
</tr>
<tr>
<td>S_BINARY</td>
<td>[V_STATUS or V_LIGHT]</td>
</tr>
<tr>
<td>S_SPRINKLER</td>
<td>V_STATUS</td>
</tr>
<tr>
<td>S_WATER_LEAK</td>
<td>V_ARMED</td>
</tr>
<tr>
<td>S_SOUND</td>
<td>V_ARMED</td>
</tr>
<tr>
<td>S_VIBRATION</td>
<td>V_ARMED</td>
</tr>
<tr>
<td>S_MOISTURE</td>
<td>V_ARMED</td>
</tr>
</tbody>
</table>
<h3>MySensors version 2.0 and higher <a class="title-link" name="mysensors-version-20-and-higher-2" href="#mysensors-version-20-and-higher-2"></a>
</h3>
<table>
<thead>
<tr>
<th>S_TYPE</th>
<th>V_TYPE</th>
</tr>
</thead>
<tbody>
<tr>
<td>S_WATER_QUALITY</td>
<td>V_STATUS</td>
</tr>
</tbody>
</table>
<p>All V_TYPES for each S_TYPE above are required to activate the actuator for the platform. Use either V_LIGHT or V_STATUS depending on library version for cases where that V_TYPE is required.</p>
<h3>Switch example sketch <a class="title-link" name="switch-example-sketch" href="#switch-example-sketch"></a>
</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="cpp"><span class="cm">/*
 * Documentation: https://www.mysensors.org
 * Support Forum: https://forum.mysensors.org
 *
 * https://www.mysensors.org/build/relay
 */</span>

<span class="cp">#include</span> <span class="cpf">&lt;MySensor.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;SPI.h&gt;</span><span class="cp">
</span>
<span class="cp">#define SN "Relay"
#define SV "1.0"
#define CHILD_ID 1
#define RELAY_PIN 3
</span>
<span class="n">MySensor</span> <span class="n">gw</span><span class="p">;</span>
<span class="n">MyMessage</span> <span class="nf">msgRelay</span><span class="p">(</span><span class="n">CHILD_ID</span><span class="p">,</span> <span class="n">V_STATUS</span><span class="p">);</span>

<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">gw</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="n">incomingMessage</span><span class="p">);</span>
  <span class="n">gw</span><span class="p">.</span><span class="n">sendSketchInfo</span><span class="p">(</span><span class="n">SN</span><span class="p">,</span> <span class="n">SV</span><span class="p">);</span>
  <span class="c1">// Initialize the digital pin as an output.</span>
  <span class="n">pinMode</span><span class="p">(</span><span class="n">RELAY_PIN</span><span class="p">,</span> <span class="n">OUTPUT</span><span class="p">);</span>
  <span class="n">gw</span><span class="p">.</span><span class="n">present</span><span class="p">(</span><span class="n">CHILD_ID</span><span class="p">,</span> <span class="n">S_BINARY</span><span class="p">);</span>
  <span class="n">gw</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">msgRelay</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">gw</span><span class="p">.</span><span class="n">process</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">incomingMessage</span><span class="p">(</span><span class="k">const</span> <span class="n">MyMessage</span> <span class="o">&amp;</span><span class="n">message</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">V_STATUS</span><span class="p">)</span> <span class="p">{</span>
     <span class="c1">// Change relay state.</span>
     <span class="n">digitalWrite</span><span class="p">(</span><span class="n">RELAY_PIN</span><span class="p">,</span> <span class="n">message</span><span class="p">.</span><span class="n">getBool</span><span class="p">()</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
     <span class="n">gw</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">msgRelay</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">getBool</span><span class="p">()</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">));</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<h2>Text <a class="title-link" name="text" href="#text"></a>
</h2>
<p>The following sensor types are supported:</p>
<h3>MySensors version 2.0 and higher <a class="title-link" name="mysensors-version-20-and-higher-3" href="#mysensors-version-20-and-higher-3"></a>
</h3>
<table>
<thead>
<tr>
<th>S_TYPE</th>
<th>V_TYPE</th>
</tr>
</thead>
<tbody>
<tr>
<td>S_INFO</td>
<td>V_TEXT</td>
</tr>
</tbody>
</table>
<h3>Text example sketch <a class="title-link" name="text-example-sketch" href="#text-example-sketch"></a>
</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="cpp"><span class="cm">/*
 * Documentation: https://www.mysensors.org
 * Support Forum: https://forum.mysensors.org
 */</span>

<span class="c1">// Enable debug prints to serial monitor</span>
<span class="cp">#define MY_DEBUG
#define MY_RADIO_NRF24
</span>
<span class="cp">#include</span> <span class="cpf">&lt;MySensors.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;SPI.h&gt;</span><span class="cp">
</span>
<span class="cp">#define SN "TextSensor"
#define SV "1.0"
#define CHILD_ID 1
</span>
<span class="n">MyMessage</span> <span class="nf">textMsg</span><span class="p">(</span><span class="n">CHILD_ID</span><span class="p">,</span> <span class="n">V_TEXT</span><span class="p">);</span>
<span class="kt">bool</span> <span class="n">initialValueSent</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">setup</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">presentation</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">sendSketchInfo</span><span class="p">(</span><span class="n">SN</span><span class="p">,</span> <span class="n">SV</span><span class="p">);</span>
  <span class="n">present</span><span class="p">(</span><span class="n">CHILD_ID</span><span class="p">,</span> <span class="n">S_INFO</span><span class="p">,</span> <span class="s">"TextSensor1"</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">initialValueSent</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Sending initial value"</span><span class="p">);</span>
    <span class="c1">// Send initial values.</span>
    <span class="n">send</span><span class="p">(</span><span class="n">textMsg</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="s">"-"</span><span class="p">));</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Requesting initial value from controller"</span><span class="p">);</span>
    <span class="n">request</span><span class="p">(</span><span class="n">CHILD_ID</span><span class="p">,</span> <span class="n">V_TEXT</span><span class="p">);</span>
    <span class="n">wait</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="n">C_SET</span><span class="p">,</span> <span class="n">V_TEXT</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">receive</span><span class="p">(</span><span class="k">const</span> <span class="n">MyMessage</span> <span class="o">&amp;</span><span class="n">message</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">V_TEXT</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">initialValueSent</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Receiving initial value from controller"</span><span class="p">);</span>
      <span class="n">initialValueSent</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">// Dummy print</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"Message: "</span><span class="p">);</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">sensor</span><span class="p">);</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">", Message: "</span><span class="p">);</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">getString</span><span class="p">());</span>
    <span class="c1">// Send message to controller</span>
    <span class="n">send</span><span class="p">(</span><span class="n">textMsg</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">getString</span><span class="p">()));</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>


  


  
<div class="material-card text feedback">
  <h4>
<iconify-icon inline icon="mdi:feedback" title="Feedback"></iconify-icon> <b> Help us improve our documentation</b><a href="#feedback_section" class="title-link" name="feedback_section"></a>
</h4>
  Suggest an edit to this page, or provide/view feedback for this page.
  <div class="links">
    <ul aria-label="Page feedback options">
    <li><a href="https://github.com/home-assistant/home-assistant.io/tree/current/source/_integrations/mysensors.markdown" target="_blank" title="Edit this page"><iconify-icon inline icon="mdi:edit"></iconify-icon> Edit</a></li>
    
    <li><a href="https://github.com/home-assistant/home-assistant.io/issues/new?template=feedback.yml&amp;url=https%3A%2F%2Fivangrod.github.io%2Fintegrations%2Fmysensors%2F&amp;version=2025.9.4&amp;labels=current,integration%3A%20mysensors" target="_blank" title="Provide feedback on this page"><iconify-icon inline icon="mdi:comment-edit-outline"></iconify-icon> Provide feedback</a></li>
    <li><a href="https://github.com/home-assistant/home-assistant.io/issues?q=is%3Aissue+is%3Aopen+sort%3Aupdated-desc+label%3A%22integration%3A+mysensors%22" target="_blank" title="View pending feedback for this page"><iconify-icon inline icon="mdi:comment-text-multiple-outline"></iconify-icon> View pending feedback</a></li>
    
  </ul>
  </div>
</div>


</article>

            
          </div>


          
            
              <aside id="integration-sidebar" class="grid__item one-third desk-wide-one-quarter lap-one-whole palm-one-whole">
              
            <div class="grid">
  




  


<section class="aside-module grid__item one-whole lap-one-half">
  <div class='brand-logo-container section'>
      <img src='https://brands.home-assistant.io/_/mysensors//logo.png' srcset='https://brands.home-assistant.io/_/mysensors/logo@2x.png 2x' /><a href='https://my.home-assistant.io/redirect/config_flow_start?domain=mysensors' class='my badge' target='_blank'><img src='https://my.home-assistant.io/badges/config_flow_start.svg' /></a></div>

  <div class='section'>The MySensors  integration  was introduced in Home Assistant 0.73, and it's used by <a title="Open analytics.home-assistant.io" href="https://analytics.home-assistant.io/integrations" target="_blank" rel="noopener">
        
          476</a> active installations.
        
      
    
  </div>
    <div class='section'>
      <iconify-icon icon='mdi:upload-network-outline'></iconify-icon>&nbsp;Its IoT class is <a href='/blog/2016/02/12/classifying-the-internet-of-things/#classifiers'>Local Push.</a>
    </div>
  <div class='section'>
    <a href="https://github.com/home-assistant/core/tree/dev/homeassistant/components/mysensors" target="_blank"><iconify-icon inline icon='simple-icons:github' title='Github'></iconify-icon> View source on GitHub</a><br />
    <a href="https://github.com/home-assistant/core/issues?q=is%3Aissue+is%3Aopen+label%3A%22integration%3A+mysensors%22" target="_blank"><iconify-icon inline icon='mdi:bug' title='Bug'></iconify-icon> View known issues</a>
  </div></section>

<section class="aside-module grid__item one-whole lap-one-half">
  <div class='section'>
    <h1 class="title epsilon"><iconify-icon inline icon='mdi:person-heart' title='Person heart'></iconify-icon> Integration owners</h1>
    
        
        

          
          <div class="section">
            We are incredibly grateful to the following contributors who currently maintain this integration:<br />
          </div>
          <div class="section"><a href="https://github.com/MartinHjelmare" target="_blank"><img class="codeowner-avatar" src="https://avatars.githubusercontent.com/MartinHjelmare?size=96" alt="@MartinHjelmare"/> @MartinHjelmare</a><br /><a href="https://github.com/functionpointer" target="_blank"><img class="codeowner-avatar" src="https://avatars.githubusercontent.com/functionpointer?size=96" alt="@functionpointer"/> @functionpointer</a><br /></div>
        
    
  </div>
</section>






  <section id="toc-module" class="aside-module grid__item one-whole lap-one-half">
        <div class='section'>
          <h1 class="title epsilon"><iconify-icon inline icon='mdi:toc' title='Toc'></iconify-icon> On this page</h1>
          <ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="#configuration">Configuration</a>
<ul>
<li class="toc-entry toc-h3"><a href="#serial-gateway">Serial gateway</a></li>
<li class="toc-entry toc-h3"><a href="#mqtt-gateway">MQTT gateway</a></li>
<li class="toc-entry toc-h3"><a href="#ethernet-gateway">Ethernet gateway</a></li>
<li class="toc-entry toc-h3"><a href="#general-options">General options</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#presentation">Presentation</a></li>
<li class="toc-entry toc-h2"><a href="#smartsleep">SmartSleep</a></li>
<li class="toc-entry toc-h2"><a href="#message-validation">Message validation</a></li>
<li class="toc-entry toc-h2"><a href="#debug-logging">Debug logging</a></li>
<li class="toc-entry toc-h2"><a href="#binary-sensor">Binary sensor</a>
<ul>
<li class="toc-entry toc-h3"><a href="#mysensors-version-14-and-higher">MySensors version 1.4 and higher</a></li>
<li class="toc-entry toc-h3"><a href="#mysensors-version-15-and-higher">MySensors version 1.5 and higher</a></li>
<li class="toc-entry toc-h3"><a href="#binary-sensor-example-sketch">Binary sensor example sketch</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#climate">Climate</a>
<ul>
<li class="toc-entry toc-h3"><a href="#mysensors-version-15-and-higher-1">MySensors version 1.5 and higher</a></li>
<li class="toc-entry toc-h3"><a href="#climate-example-sketch-for-mysensors-2x">Climate example sketch for MySensors 2.x</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#cover">Cover</a>
<ul>
<li class="toc-entry toc-h3"><a href="#mysensors-version-14">MySensors version 1.4</a></li>
<li class="toc-entry toc-h3"><a href="#mysensors-version-15-and-higher-2">MySensors version 1.5 and higher</a></li>
<li class="toc-entry toc-h3"><a href="#cover-example-sketch">Cover example sketch</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#device-tracker">Device tracker</a>
<ul>
<li class="toc-entry toc-h3"><a href="#mysensors-version-20-and-higher">MySensors version 2.0 and higher</a></li>
<li class="toc-entry toc-h3"><a href="#device-tracker-example-sketch-for-mysensors-2x">Device tracker example sketch for MySensors 2.x</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#light">Light</a>
<ul>
<li class="toc-entry toc-h3"><a href="#mysensors-version-14-1">MySensors version 1.4</a></li>
<li class="toc-entry toc-h3"><a href="#mysensors-version-15-and-higher-3">MySensors version 1.5 and higher</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#remote">Remote</a>
<ul>
<li class="toc-entry toc-h3"><a href="#mysensors-version-14-and-higher-1">MySensors version 1.4 and higher</a></li>
<li class="toc-entry toc-h3"><a href="#mysensors-version-15-and-higher-4">MySensors version 1.5 and higher</a></li>
<li class="toc-entry toc-h3"><a href="#ir-transceiver-example-sketch">IR transceiver example sketch</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#sensor">Sensor</a>
<ul>
<li class="toc-entry toc-h3"><a href="#mysensors-version-14-and-higher-2">MySensors version 1.4 and higher</a></li>
<li class="toc-entry toc-h3"><a href="#mysensors-version-20-and-higher-1">MySensors version 2.0 and higher</a></li>
<li class="toc-entry toc-h3"><a href="#custom-unit-of-measurement">Custom unit of measurement</a></li>
<li class="toc-entry toc-h3"><a href="#sensor-example-sketch-for-mysensors-2x">Sensor example sketch for MySensors 2.x</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#switch">Switch</a>
<ul>
<li class="toc-entry toc-h3"><a href="#mysensors-version-14-and-higher-3">MySensors version 1.4 and higher</a></li>
<li class="toc-entry toc-h3"><a href="#mysensors-version-15-and-higher-5">MySensors version 1.5 and higher</a></li>
<li class="toc-entry toc-h3"><a href="#mysensors-version-20-and-higher-2">MySensors version 2.0 and higher</a></li>
<li class="toc-entry toc-h3"><a href="#switch-example-sketch">Switch example sketch</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#text">Text</a>
<ul>
<li class="toc-entry toc-h3"><a href="#mysensors-version-20-and-higher-3">MySensors version 2.0 and higher</a></li>
<li class="toc-entry toc-h3"><a href="#text-example-sketch">Text example sketch</a></li>
</ul>
</li>
</ul>
        </div>
      </section><section id="category-module" class="aside-module grid__item one-whole lap-one-half">
      <div class='section'>
        <h1 class="title epsilon"><iconify-icon inline icon='mdi:category' title='Category'></iconify-icon> Categories</h1>
        <ul class='divided'><li>
            <a href='/integrations/#diy'>DIY</a>
          </li></ul>
      </div>
    </section></div>

          </aside>
          
        </div>
      </div>

      <footer>
        <div class="grid-wrapper">
  <div class="grid">
    <div class="grid__item">
      <div class="skyline grid">
        <div class="skyline grid__item one-whole">
          <div class="footer-skyline">
          </div>
        </div>
      </div>
      <div class="footer-nav grid">
        <div class="company grid__item one-quarter lap-one-half palm-one-whole">
          <div class="title">
            <img
              src="/needlehack-blog/images/footer-logo-text.svg"
              height="72"
              alt="Home Assistant"
            />
          </div>
          <p>
            Home Assistant is a project from the <a href="https://www.openhomefoundation.org/">Open Home Foundation</a>, sponsored by <a href="https://www.nabucasa.com/">Nabu Casa</a>.
          </p>
        </div>

        <div class="grid__item one-quarter lap-one-half palm-one-whole">
          <h3>Join us and contribute!</h3>
          <ul>
            <li><a class="external-link" href="https://github.com/home-assistant/">GitHub repo <iconify-icon inline icon='tabler:external-link' title='External link'></iconify-icon></a></li>
            <li><a class="external-link" href="https://developers.home-assistant.io">Developers Portal <iconify-icon inline icon='tabler:external-link' title='External link'></iconify-icon></a></li>
            <li><a class="external-link" href="https://design.home-assistant.io">Design Portal <iconify-icon inline icon='tabler:external-link' title='External link'></iconify-icon></a></li>
            <li><a class="external-link" href="https://data.home-assistant.io">Data Science Portal <iconify-icon inline icon='tabler:external-link' title='External link'></iconify-icon></a></li>
            <li><a class="external-link" href="https://community.home-assistant.io">Community Forum <iconify-icon inline icon='tabler:external-link' title='External link'></iconify-icon></a></li>
            <li><a class="external-link" href="https://creators.home-assistant.io/">Creator Network <iconify-icon inline icon='tabler:external-link' title='External link'></iconify-icon></a></li>
            <li><a class="external-link" href="https://works-with.home-assistant.io/">Works With Home Assistant <iconify-icon inline icon='tabler:external-link' title='External link'></iconify-icon></a></li>
            <li><a href="/needlehack-blog/community">Our community</li>
            <li><a href="/needlehack-blog/help/reporting_issues/">Reporting issues</a></li>
          </ul>
          <h3>System status</h3>
          <ul>
            <li>
              <a class="external-link"  href="https://alerts.home-assistant.io">Integration Alerts <iconify-icon inline icon='tabler:external-link' title='External link'></iconify-icon></a>
            </li>
            <li><a href="/needlehack-blog/security/">Security Alerts</a></li>
            <li>
              <a class="external-link" href="https://status.home-assistant.io">System Status <iconify-icon inline icon='tabler:external-link' title='External link'></iconify-icon></a>
            </li>
          </ul>
        </div>

        <div class="grid__item one-quarter lap-one-half palm-one-whole">
          <h3>Companion apps</h3>
          <ul>
            <li><a class="external-link" href="https://apps.apple.com/us/app/home-assistant/id1099568401">iOS and Apple devices</a></li>
            <li><a class="external-link" href="https://play.google.com/store/apps/details?id=io.homeassistant.companion.android">Android and Wear OS</a></li>
            <li><a class="external-link" href="https://companion.home-assistant.io/">...and more!</a></li>
          </ul>
          <h3>Governance</h3>
          <ul>
            <li><a href="/needlehack-blog/privacy/">Privacy Notices</a></li>
            <li><a href="/needlehack-blog/developers/cla/">Contributor License Agreement</a></li>
            <li><a href="/needlehack-blog/tos/">Terms of Service</a></li>
            <li><a href="/needlehack-blog/code_of_conduct/">Code of Conduct</a></li>
            <li><a href="/needlehack-blog/developers/credits/">Credits</a></li>
            <li><a href="/needlehack-blog/developers/license/">License</a></li>
          </ul>
        </div>

        <div class="socials grid__item one-quarter lap-one-half palm-one-whole">

          <h3>Follow us</h3>
          <p><a class="external-link" href='https://newsletter.openhomefoundation.org/#/portal'>Sign up for our newsletter <iconify-icon inline icon='tabler:external-link' title='External link'></iconify-icon></a></p>
          <div class="icons">
            <a
              rel="me"
              href="https://youtube.com/@home_assistant"
              title="YouTube"
              target="_blank"
              ><iconify-icon icon="simple-icons:youtube"></iconify-icon></a>
            <a
              rel="me"
              href="https://reddit.com/r/homeassistant"
              title="Reddit"
              target="_blank"
              ><iconify-icon icon="simple-icons:reddit"></iconify-icon></a>
            <a
              rel="me"
              href="https://github.com/home-assistant/home-assistant"
              title="GitHub"
              target="_blank"
              ><iconify-icon icon="simple-icons:github"></iconify-icon></a>
            <br />
            <a
              rel="me"
              href="https://fosstodon.org/@homeassistant"
              title="Mastodon"
              target="_blank"
              ><iconify-icon icon="simple-icons:mastodon"></iconify-icon></a>
            <a
              rel="me"
              href="https://bsky.app/profile/home-assistant.io"
              title="Bluesky"
              target="_blank"
             ><iconify-icon icon="simple-icons:bluesky"></iconify-icon></a>
            <a
              rel="me"
              href="https://x.com/home_assistant"
              title="X"
              target="_blank"
             ><iconify-icon icon="simple-icons:x"></iconify-icon></a>
            <br />
            <a
              rel="me"
              href="https://www.facebook.com/homeassistantio"
              title="Facebook"
              target="_blank"
              ><iconify-icon icon="simple-icons:facebook"></iconify-icon></a>
            <a
              rel="me"
              href="https://www.instagram.com/homeassistant/"
              title="Instagram"
              target="_blank"
              ><iconify-icon icon="simple-icons:instagram"></iconify-icon></a>
            <a
              rel="me"
              href="https://www.linkedin.com/company/home-assistant"
              title="LinkedIn"
              target="_blank"
              ><iconify-icon icon="simple-icons:linkedin"></iconify-icon></a>
          </div>

          <div class="web-notice">
            <p>
              For partnership inquiries please check out <a href="https://works-with.home-assistant.io/">Works With Home Assistant</a>. For media, get in touch <a href="mailto:media@openhomefoundation.org">here</a>. For other questions, you can contact us <a href="mailto:hello@home-assistant.io">here</a> (No technical support!)
            </p>
            <p>
              Website powered by <a href="https://jekyllrb.com/">Jekyll</a><br />
              Originally based on the <a href="https://github.com/coogie/oscailte">Oscailte theme</a>
            </p>
            <a href="https://www.netlify.com">
              <img
                src="/needlehack-blog/images/frontpage/netlify.svg"
                alt="Deploys by Netlify Badge"
              />
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

      </footer>

    </div>
    <script type="module" src="https://cdn.jsdelivr.net/npm/@justinribeiro/lite-youtube@1.3.1/lite-youtube.js"></script>

<script src="/javascripts/terminology_tooltip.js?274cec0734bc752f0e5ea3d4e2e59858" type="text/javascript" defer></script>

<script src="/javascripts/prism.js?5d6619066a1fc5cd819a93c132b539ac" type="text/javascript" defer></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@docsearch/js@3/dist/umd/index.min.js"></script>
<script type="text/javascript">
  docsearch({
    container: '#docsearch',
    appId: 'FBHBYS3J0U',
    indexName: 'home-assistant',
    apiKey: "ba6f7e6d97b3d3d2f778978c742a47c6",
  });
  document.querySelector('.site-title').addEventListener('contextmenu', function (ev) {
    ev.preventDefault();
    document.location.assign("https://design.home-assistant.io/#brand/logo")
  });
</script>




<script type="text/javascript">
  {
    const article = document.querySelector("article.post");
    if (article) {
      const iframes = article.querySelectorAll("iframe[data-src]");
      let loaded = false;
      if (iframes) {
        document.addEventListener('mousemove', loadLazyFrames, { passive: true, once: true });
        document.addEventListener('touchmove', loadLazyFrames, { passive: true, once: true });
        document.addEventListener('scroll', loadLazyFrames, { passive: true, once: true });
  
        function loadLazyFrames() {
          if (loaded) return;
          loaded = true;
  
          iframes.forEach((iframe) => {
            const src = iframe.getAttribute("data-src");
            if (src) {
              iframe.setAttribute("src", src);
              iframe.removeAttribute("data-src");
            }
          });
        }
      }
    }
  }
</script>

  </body>
</html>
